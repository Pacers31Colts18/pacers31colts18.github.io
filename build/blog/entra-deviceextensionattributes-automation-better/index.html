<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-blog" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">An even better way to automate Entra Device Extension Attributes with Intune Remediation Scripts and Azure Automation | Joe Loveless</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://joeloveless.com/img/social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://joeloveless.com/img/social-card.jpg"><meta data-rh="true" property="og:url" content="https://joeloveless.com/blog/entra-deviceextensionattributes-automation-better"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="An even better way to automate Entra Device Extension Attributes with Intune Remediation Scripts and Azure Automation | Joe Loveless"><meta data-rh="true" name="description" content="A better process for automating the tagging of Entra Device Extension Attributes with Intune Remediation Scripts and Azure Automation Runbooks."><meta data-rh="true" property="og:description" content="A better process for automating the tagging of Entra Device Extension Attributes with Intune Remediation Scripts and Azure Automation Runbooks."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-04-12T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="Intune,Entra,Azure"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://joeloveless.com/blog/entra-deviceextensionattributes-automation-better"><link data-rh="true" rel="alternate" href="https://joeloveless.com/blog/entra-deviceextensionattributes-automation-better" hreflang="en"><link data-rh="true" rel="alternate" href="https://joeloveless.com/blog/entra-deviceextensionattributes-automation-better" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://joeloveless.com/blog/entra-deviceextensionattributes-automation-better","mainEntityOfPage":"https://joeloveless.com/blog/entra-deviceextensionattributes-automation-better","url":"https://joeloveless.com/blog/entra-deviceextensionattributes-automation-better","headline":"An even better way to automate Entra Device Extension Attributes with Intune Remediation Scripts and Azure Automation","name":"An even better way to automate Entra Device Extension Attributes with Intune Remediation Scripts and Azure Automation","description":"A better process for automating the tagging of Entra Device Extension Attributes with Intune Remediation Scripts and Azure Automation Runbooks.","datePublished":"2025-04-12T00:00:00.000Z","author":[],"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://joeloveless.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Joe Loveless RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Joe Loveless Atom Feed">




<script defer="defer" src="https://cloud.umami.is/script.js" data-website-id="50771638-05b4-4125-a8fd-c8e7e72e57e5"></script><link rel="stylesheet" href="/assets/css/styles.77ea03e4.css">
<script src="/assets/js/runtime~main.04602d8d.js" defer="defer"></script>
<script src="/assets/js/main.7b5a6ddd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/blog/tags">Tags</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/expanding-my-homelab-with-cloudflare-tailscale-and-more">Expanding my Home Lab with Cloudflare, Tailscale, and more</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tracking-chores-with-home-assistant">Tracking Chores with Home Assistant</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/what-settings-are-in-intune">What Group Policy Settings aren&#x27;t in Microsoft Intune?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/exploring-microsoft-intune-filters">Exploring Microsoft Intune Filters</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/making-dexcom-better-wtih-homeassistant">Making Dexcom better with Home Assistant Voice</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">An even better way to automate Entra Device Extension Attributes with Intune Remediation Scripts and Azure Automation</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-04-12T00:00:00.000Z">April 12, 2025</time> · <!-- -->9 min read</div></header><div id="__blog-post-container" class="markdown"><p>A better process for automating the tagging of Entra Device Extension Attributes with Intune Remediation Scripts and Azure</p>
<p>In my last post, I wrote about how we can use Intune Remediation Scripts, Azure Automation, and Enterprise App Registrations to automate the tagging of device extension attributes on an Entra ID device. From here we can create Entra groups that are dynamic, and constantly updated based on data that we are looking for on the device. I gave the example of adding the domain name to extensionAttribute1, and creating groups based off that for targeting. While what I showed worked, <a href="https://nathanmcnulty.com/" target="_blank" rel="noopener noreferrer" class="">Nathan McNulty</a>, provided some feedback:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/linkedin-5c7b737d61c896f683fb8e6ca17315c3.png" title="Nathan McNulty LinkedIn" width="547" height="304" class="img_ev3q"></p>
<p>After reading through his post on automating <a href="https://nathanmcnulty.com/blog/2023/04/azure-automation-device-cleanup-v2/#grant-devicereadwriteall-permissions" target="_blank" rel="noopener noreferrer" class="">Entra device cleanup</a>, I wanted to share an update along with another example on how to accomplish this. In this post, I&#x27;ll walk through the new configuration, and also give a new example based on the OU the workstation resides in. Beware, some of this might be repetitive.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="intune-remediation-script">Intune Remediation Script<a href="#intune-remediation-script" class="hash-link" aria-label="Direct link to Intune Remediation Script" title="Direct link to Intune Remediation Script" translate="no">​</a></h2>
<p>First we will setup the Intune Remediation Script. For this, we are only going to be using a Detection method, as we&#x27;re just looking to read data on the device. In the detection script, I am looking to gather the CN of the device from the registry. From there, I am going to do some RegEx manipulation, to just pull the OU the device resides in. I&#x27;m not looking for the parent OUs, or the CN, just the direct OU.</p>
<p><a href="https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/remediations" target="_blank" rel="noopener noreferrer" class="">Intune Remediations - Microsoft Learn</a></p>
<ul>
<li class="">In the Intune portal, click on Devices &gt; Scripts and Remediations</li>
<li class="">Go through the basics of creating the remediation script.</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/remediation-174648eceeaf813e0eb4658870deae21.png" title="Remediation setup" width="853" height="481" class="img_ev3q"></p>
<ul>
<li class="">Using the script below as an example, upload the script file as a Detection, and leave everything else as default. <a href="https://github.com/Pacers31Colts18/Intune/blob/main/RemediationScripts/ExtensionAttributes/ExtensionAttribute2_Detection_OU.ps1" target="_blank" rel="noopener noreferrer" class="">Detection Script</a></li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/remediation2-1f449c8f7104df51ee1560b3ae289a01.png" title="Remediation setup" width="850" height="717" class="img_ev3q"></p>
<ul>
<li class="">Add the groups you want to target, along with the schedule you want. In this use case, I am choosing to run this daily, as the device could be moved to a different OU.. If there is a need for other schedules, adjust as you see fit. I would recommend for software detection, or other data that could change a different schedule.</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/remediation3-015ccc50e64af41d779bd7e5e81eef38.png" title="Remediation assignment" width="704" height="612" class="img_ev3q"></p>
<p>After the script runs (which thankfully you can also run manually now for testing purposes), let&#x27;s do the following.</p>
<ul>
<li class="">From the Scripts and Remedations node, choose your script.</li>
<li class="">Go to Monitor &gt; Device Status</li>
<li class="">Under the Column selection, add <strong>Pre-Remediation detection output</strong></li>
<li class="">Windows_11 is the OU that my device is joined to.</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/remediation4-96e3ff6d4d6ba77dc15e446a467141b6.png" title="Pre-remediation detection output" width="1774" height="240" class="img_ev3q"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="app-registration"><del>App Registration</del><a href="#app-registration" class="hash-link" aria-label="Direct link to app-registration" title="Direct link to app-registration" translate="no">​</a></h2>
<p>~~We will also need to configure an App Registration for this process to work. ~~</p>
<p><del>- Go to your Azure Portal, and search for App Registration.</del>
<del>- Create a new App Registration with the following configuration:</del></p>
<p><del>- Create a new client secret under the <strong>Secrets</strong> node. Take note of the secret, as you will need it later.</del></p>
<p><del>- Go to Overview, and make note of the Directory (tenant) ID, and Application (client) ID. You will need this for the Azure Automation portion.</del></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="azure-automation">Azure Automation<a href="#azure-automation" class="hash-link" aria-label="Direct link to Azure Automation" title="Direct link to Azure Automation" translate="no">​</a></h2>
<ul>
<li class="">From the Azure Portal, search for Automation Accounts</li>
<li class="">Click Create</li>
<li class="">If a Resource Group is not available, you will need to create one</li>
<li class="">Once created, on the left hand pane, go to <strong>Identity</strong> under Account Settings</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/automation_objectid-fc0dfe05b2365c0a4146e7e319aa5e25.png" width="512" height="370" class="img_ev3q"></p>
<ul>
<li class="">Make note of the Object Id, we&#x27;ll need it later.</li>
</ul>
<p><del>- Here we are going to store the previous items that we made note of. Each item will have a Type of <strong>String</strong></del>
<del>- ClientID</del>
<del>- ClientSecret</del>
<del>- TenantID</del>
<del>- Make sure they are named in the same format, or you will need to adjust the runbook.</del></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="modules">Modules<a href="#modules" class="hash-link" aria-label="Direct link to Modules" title="Direct link to Modules" translate="no">​</a></h3>
<p>Learning more from Nathan, I too went with installing modules from the Powershell Gallery to help ease the management of this.</p>
<ul>
<li class="">Go to Modules under Shared Resources</li>
</ul>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" title="Modules" width="251" height="214" class="img_ev3q"></p>
<ul>
<li class="">Click Add a Module</li>
<li class="">Choose Browse from Gallery</li>
<li class="">We are going to install two modules:<!-- -->
<ul>
<li class="">Microsoft.Graph.Authentication</li>
</ul>
</li>
</ul>
<p>Is this module 100% necessary? No not really, but it does make the connection simpler in my opinion. The modules are also updated by Microsoft, so less management. If you wanted, a combination of the runbook from the initial post, and the runbook from this could be combined and eliminate the need for the module.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="assigning-permissions">Assigning Permissions<a href="#assigning-permissions" class="hash-link" aria-label="Direct link to Assigning Permissions" title="Direct link to Assigning Permissions" translate="no">​</a></h2>
<p>According to Nathan&#x27;s post, the permissions are not configurable through the GUI. I found this to be accurate, both in my lab environment and at work. When running this in my production environment, I needed someone with GA permissions to configure this portion. Whether GA is actually the right permission needed or not, I&#x27;m not 100% sure. In my lab of course, I&#x27;m running GA, while at work, I have limited permissions. I probably shouldn&#x27;t be running GA in my lab either, but I&#x27;m still setting it up and learning....one day. Using Nathan&#x27;s script on his <a href="https://nathanmcnulty.com/blog/2023/04/azure-automation-device-cleanup-v2/#grant-devicereadwriteall-permissions" target="_blank" rel="noopener noreferrer" class="">blog post</a>, we are going to add three permissions, and the objectId that we took note of above.</p>
<p>To Modify:</p>
<ul>
<li class="">$SP_ID<!-- -->
<ul>
<li class="">Add the object ID from your Azure Automation account.</li>
</ul>
</li>
<li class="">Permissions<!-- -->
<ul>
<li class="">DeviceManagementManagedDevices.Read.All</li>
<li class="">DeviceManagementConfiguration.Read.All</li>
<li class="">Device.ReadWrite.All</li>
</ul>
</li>
<li class="">We&#x27;re then going to run this script each time for the permissions needed (3 total).</li>
</ul>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#Variables to Modify</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$SP_ID = &#x27;Object (prinicpal) ID from above&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$AppId = (Get-MgServicePrincipal -ServicePrincipalId $SP_ID).AppId</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Connect with scopes requried to grant permissions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># May require admin consent for Graph PowerShell</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Connect-MgGraph -Scopes appRoleAssignment.ReadWrite.All,Application.Read.All,Group.ReadWrite.All</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Grant Device.ReadWrite.All Graph Permissions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;Device.ReadWrite.All&quot; | ForEach-Object {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   $PermissionName = $_</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   $GraphSP = Get-MgServicePrincipal -Filter &quot;startswith(DisplayName,&#x27;Microsoft Graph&#x27;)&quot; | Select-Object -first 1 #Graph App ID: 00000003-0000-0000-c000-000000000000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   $AppRole = $GraphSP.AppRoles | Where-Object {$_.Value -eq $PermissionName -and $_.AllowedMemberTypes -contains &quot;Application&quot;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   New-MgServicePrincipalAppRoleAssignment -AppRoleId $AppRole.Id -ServicePrincipalId $SP_ID -ResourceId $GraphSP.Id -PrincipalId $SP_ID</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="enterprise-applications">Enterprise Applications<a href="#enterprise-applications" class="hash-link" aria-label="Direct link to Enterprise Applications" title="Direct link to Enterprise Applications" translate="no">​</a></h2>
<p>In the previous post, we created the Enterprise Application and configured the permissions. Now with Nathan&#x27;s script, this will configure the Enterprise Application, and tie the managed identity to the application. The Azure Automation account and the Enterprise Application will have the same name. We can go into the portal and verify everything is correct.</p>
<ul>
<li class="">From the Azure Portal, go to Enterprise Applications</li>
<li class="">By default, the view will be Enterprise Applications, it took me a minute of stumbling around myself to find the application. We will want to change the view to Managed Identity.</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/enterpriseapplications_default-a671da062ff9d74ce410877a670e6868.png" title="Default view" width="773" height="187" class="img_ev3q"></p>
<ul>
<li class="">Change this to <strong>Managed Identites</strong></li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/enetpriseapplications_managed-16e4a86d93f1f64ad86cf5ded7acf102.png" title="Managed Identities" width="1512" height="163" class="img_ev3q"></p>
<p>Do you see the Certificate Expiry Status being Managed by Microsoft. This will make the whole process so much easier. Nobody wants to deal with secrets/certificates expiring and things not working anymore. With the Managed Identity configuration, Microsoft manages this for us! We got better <del>shit</del> stuff to do!</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="runbook">Runbook<a href="#runbook" class="hash-link" aria-label="Direct link to Runbook" title="Direct link to Runbook" translate="no">​</a></h3>
<p>Ok now we have the Azure Automation tied to the Enterprise Application, now we&#x27;re ready to go back and create the Runbook.</p>
<ul>
<li class="">Go back to Azure Automation<!-- -->
<ul>
<li class="">Under Process Automation, choose Runbooks</li>
<li class="">Create a new Runbook</li>
<li class="">Make sure to choose Powershell 5.1</li>
</ul>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" title="Runbook creation" width="751" height="261" class="img_ev3q"></p>
<ul>
<li class="">Click Review and Create</li>
<li class="">This should then take you to a terminal window</li>
<li class="">Copy and paste the code here: <a href="https://github.com/Pacers31Colts18/Intune/blob/main/RemediationScripts/ExtensionAttributes/ExtensionAttribute2_Runbook_OU.ps1" target="_blank" rel="noopener noreferrer" class="">Runbook</a></li>
<li class="">The top three lines are all that should need to be modified to your liking</li>
</ul>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#Variables to Modify</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$scriptName = &quot;JoeLoveless - ExtensionAttributes - OrganizationalUnit&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$appregistrationName = &quot;JoeLoveless-Intune-ExtensionAttributes&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$extensionAttribute = &quot;extensionAttribute2&quot;</span><br></span></code></pre></div></div>
<ul>
<li class="">The $scriptName variable should match the Intune Remediation Script.</li>
<li class="">The $appregistrationName should match the name of the App Registration.</li>
<li class="">The $extensionAttribute should be &quot;extenstionAttribute&quot; and the number you want to tag.<!-- -->
<ul>
<li class="">1-15 are the allowed extension attributes <a href="https://learn.microsoft.com/en-us/graph/api/resources/device?view=graph-rest-1.0" target="_blank" rel="noopener noreferrer" class="">Microsoft Learn</a></li>
</ul>
</li>
<li class="">Once configured, let&#x27;s make sure it works properly before going any further. Click on Test Pane. If all succeeds, you should see a Succeeded message.</li>
<li class="">Although it says succedeed, did it really? Go to a device in the Entra portal, and take a look at one.</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/extensionattribute-d104ec22c1222de43b1bcc28e5c9a25e.png" title="Extension Attribute on the device" width="749" height="648" class="img_ev3q"></p>
<p>Success, we now have tagged a device with an Extension Attribute!!!</p>
<p><img decoding="async" loading="lazy" src="/assets/images/yes-7b20bc43fbabae3395f42f44d3b414a5.gif" title="Yes" width="775" height="425" class="img_ev3q"></p>
<ul>
<li class="">
<p>First, let&#x27;s go back to our Runbook, and we need to Publish the runbook.
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="751" height="261" class="img_ev3q"></p>
</li>
<li class="">
<p>Now that we have published the runbook, we can now configure a schedule.</p>
</li>
<li class="">
<p>Under Resources, select Schedules and then Add Schedule.</p>
</li>
<li class="">
<p>Click Link a Schedule to your Runbook and then Add Schedule.</p>
</li>
<li class="">
<p>In my case, I want this to run slightly after the Intune Remediation runs. I don&#x27;t want it to run at the same time, or too close, as there could be a delay on the Microsoft side. 15 minutes seems like a good enough time for me.</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/automation_schedule-b0024e0099eda877ac76d2368d6eb50e.png" width="303" height="550" class="img_ev3q"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="groups">Groups<a href="#groups" class="hash-link" aria-label="Direct link to Groups" title="Direct link to Groups" translate="no">​</a></h2>
<p>Now that everything is configured, we can then create Entra ID groups that can be used for targeting purposes within Intune. My initial thought on this method was going to be just adding directly to the groups. While that can be good for certain, more static scenarios, the method I have outlined makes this all dynamic. With the remediation scripts running daily, along with the Azure Automation, the devices can be added/removed from the groups. If adding directly to the groups, you would need a second runbook to remove from the groups. There could be unintended consequences.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/groups-fbba696e2589a715817d71caef4526ca.png" width="925" height="439" class="img_ev3q"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion" translate="no">​</a></h2>
<p>Again, I have to thank Nathan for the feedback and advice on this. I really appreciate it and wanted to share this process. I feel like most of the automation I have seen has been with the ClientId, AppId, and ClientSecret method. While that works, I do feel like this is a better process without having to manage the secret expiration.</p>
<p><a href="https://nathanmcnulty.com/blog/2023/04/azure-automation-device-cleanup-v2/#grant-devicereadwriteall-permissions" target="_blank" rel="noopener noreferrer" class="">Azure Automation - Device Cleanup v2</a></p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Intune related posts." class="tag_zVej tagRegular_sFm0" href="/blog/tags/intune">Intune</a></li><li class="tag_QGVx"><a rel="tag" title="Entra related posts." class="tag_zVej tagRegular_sFm0" href="/blog/tags/entra">Entra</a></li><li class="tag_QGVx"><a rel="tag" title="Azure related posts." class="tag_zVej tagRegular_sFm0" href="/blog/tags/azure">Azure</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2025-04-12-entra-deviceextensionattributes-betterway/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/entra-grouprandomization"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Creating Intune Randomized Rollouts with Entra Group Membership</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/entra-deviceextensionattributes-automation"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Automating Entra Device Extension Attributes with Intune Remediation Scripts and Azure Automation</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#intune-remediation-script" class="table-of-contents__link toc-highlight">Intune Remediation Script</a></li><li><a href="#app-registration" class="table-of-contents__link toc-highlight"><del>App Registration</del></a></li><li><a href="#azure-automation" class="table-of-contents__link toc-highlight">Azure Automation</a><ul><li><a href="#modules" class="table-of-contents__link toc-highlight">Modules</a></li></ul></li><li><a href="#assigning-permissions" class="table-of-contents__link toc-highlight">Assigning Permissions</a></li><li><a href="#enterprise-applications" class="table-of-contents__link toc-highlight">Enterprise Applications</a><ul><li><a href="#runbook" class="table-of-contents__link toc-highlight">Runbook</a></li></ul></li><li><a href="#groups" class="table-of-contents__link toc-highlight">Groups</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="footer-icons">
                  <a href="https://github.com/pacers31colts18" class="footer-icon footer-icon-github" target="_blank" rel="noopener noreferrer"></a>
                  <a href="https://linkedin.com/in/joe-loveless" class="footer-icon footer-icon-linkedin" target="_blank" rel="noopener noreferrer"></a>
                  <a href="https://bsky.app/profile/joeloveless.com" class="footer-icon footer-icon-bluesky" target="_blank" rel="noopener noreferrer"></a>
                  <a href="https://infosec.exchange/@Pacers31Colts18" class="footer-icon footer-icon-mastodon" target="_blank" rel="noopener noreferrer"></a>
                  <a href="mailto:joe@joeloveless.com" class="footer-icon footer-icon-email"></a>
                  <a href="https://joeloveless.com/index.xml" class="footer-icon footer-icon-rss" target="_blank" rel="noopener noreferrer"></a>
                </div>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2025 Joe Loveless</div></div></div></footer></div>
</body>
</html>