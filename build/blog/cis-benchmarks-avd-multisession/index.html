<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-blog" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">CIS L1 Benchmarks in Intune with AVD Multi-Session Hosts | Joe Loveless</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://joeloveless.com/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://joeloveless.com/img/social-card.png"><meta data-rh="true" property="og:url" content="https://joeloveless.com/blog/cis-benchmarks-avd-multisession"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="CIS L1 Benchmarks in Intune with AVD Multi-Session Hosts | Joe Loveless"><meta data-rh="true" name="description" content="Details on what settings aren&#x27;t in scope with AVD Multi-Session hosts."><meta data-rh="true" property="og:description" content="Details on what settings aren&#x27;t in scope with AVD Multi-Session hosts."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-05-13T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="Intune,CIS,AVD"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://joeloveless.com/blog/cis-benchmarks-avd-multisession"><link data-rh="true" rel="alternate" href="https://joeloveless.com/blog/cis-benchmarks-avd-multisession" hreflang="en"><link data-rh="true" rel="alternate" href="https://joeloveless.com/blog/cis-benchmarks-avd-multisession" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://joeloveless.com/blog/cis-benchmarks-avd-multisession","mainEntityOfPage":"https://joeloveless.com/blog/cis-benchmarks-avd-multisession","url":"https://joeloveless.com/blog/cis-benchmarks-avd-multisession","headline":"CIS L1 Benchmarks in Intune with AVD Multi-Session Hosts","name":"CIS L1 Benchmarks in Intune with AVD Multi-Session Hosts","description":"Details on what settings aren't in scope with AVD Multi-Session hosts.","datePublished":"2025-05-13T00:00:00.000Z","author":[],"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://joeloveless.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Joe Loveless RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Joe Loveless Atom Feed">




<script defer="defer" src="https://cloud.umami.is/script.js" data-website-id="50771638-05b4-4125-a8fd-c8e7e72e57e5"></script><link rel="stylesheet" href="/assets/css/styles.6017bd90.css">
<script src="/assets/js/runtime~main.d4264891.js" defer="defer"></script>
<script src="/assets/js/main.129f0521.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/blog/tags">Tags</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/expanding-my-homelab-with-cloudflare-tailscale-and-more">Expanding my Home Lab with Cloudflare, Tailscale, and more</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tracking-chores-with-home-assistant">Tracking Chores with Home Assistant</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/what-settings-are-in-intune">What Group Policy Settings aren&#x27;t in Microsoft Intune?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/exploring-microsoft-intune-filters">Exploring Microsoft Intune Filters</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/making-dexcom-better-wtih-homeassistant">Making Dexcom better with Home Assistant Voice</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">CIS L1 Benchmarks in Intune with AVD Multi-Session Hosts</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-05-13T00:00:00.000Z">May 13, 2025</time> · <!-- -->9 min read</div></header><div id="__blog-post-container" class="markdown"><p>Details on what settings aren&#x27;t in scope for the Windows 11 Benchmark with AVD Multi-Session hosts.</p>
<p>What a week! Last week was MMS MOA 2025, and I still have this odd hangover from the week that I&#x27;m trying to recover from. The past couple nights I&#x27;ve been in bed by 8-9 p.m., which for my 40 year old self, isn&#x27;t that far off. The haze in general is starting to wear off, and I&#x27;m starting to get back into the swings of every day life and every day work. I always come out of MMS with such excitement, but then typically there are the work challenges that get in the way. Never the fault of the actual team I&#x27;m on mind you, just work in general. I thought about making a post about all the sessions, all the fun, and everything else that makes MMS great, but my brain is foggy, and I don&#x27;t know that I could do the week proper justice.</p>
<p>One of the questions I asked in a session about the Open Intune Baseline was surrounding AVD, and how to manage multi-session hosts. For those unfamiliar, AVD Multi-Session is running a &quot;ServerRDSH&quot; SKU, which, accurate or not, I think of these as Terminal Servers running a Windows 11 like operating system. With that, there are challenges with managing these in Intune. Microsoft, has IMO a pretty poorly written [Microsoft Learn[(<a href="https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/azure-virtual-desktop-multi-session" target="_blank" rel="noopener noreferrer" class="">https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/azure-virtual-desktop-multi-session</a>)]<!-- --> article, that vaguely lays out the limitations. As we&#x27;ve started on the AVD path, and with the amount of clicks it takes in Intune to see what settings are actually applying and what are Not Applicable, we noticed quite the drift in our settings, especially when configuring the CIS L1 Baselines. In our case, due to auditing purposes, we use CIS Windows 11 Enterprise L1, rather than the Intune baseline that has been developed.</p>
<p>Once we figured out there was a limitation in the settings, I got thinking, how can we gather this data and actually know what is applying?</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="graph-api-for-the-win">Graph API for the win<a href="#graph-api-for-the-win" class="hash-link" aria-label="Direct link to Graph API for the win" title="Direct link to Graph API for the win" translate="no">​</a></h2>
<p>When the Graph API first came out, I was confused on how this worked. Granted, I&#x27;m still confused, but just not as confused. In ITIL terms, that is considered progressing iteratively. We looked at the Graph SDK, and I quickly got frustrated by the length of some of the cmdlets, and the inconsistencies. So rather than fumbling with the cmdlets, I&#x27;ve really dove into the Graph API, and found it so much more repeatable and enjoyable. There are still gotchas, and I&#x27;m still trying to really figure out the syntax on searching, but I&#x27;m getting better.</p>
<p>I wrote a quick function, called <a href="https://github.com/Pacers31Colts18/Intune/blob/main/Export-IntuneConfigurationSettings.ps1" target="_blank" rel="noopener noreferrer" class="">Export-IntuneConfigurationSettings</a>. What this allows me to do is search the Graph URI &quot;<a href="https://graph.microsoft.com/beta/deviceManagement/configurationSettings" target="_blank" rel="noopener noreferrer" class="">https://graph.microsoft.com/beta/deviceManagement/configurationSettings</a>&quot;, for settings and return the data from that. (Settings Catalog backed only)</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="walking-through-the-script">Walking through the script<a href="#walking-through-the-script" class="hash-link" aria-label="Direct link to Walking through the script" title="Direct link to Walking through the script" translate="no">​</a></h2>
<p>I don&#x27;t like to just link a script and leave it at that, so let&#x27;s walk through it.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="parameters-connection-declarations">Parameters, Connection, Declarations<a href="#parameters-connection-declarations" class="hash-link" aria-label="Direct link to Parameters, Connection, Declarations" title="Direct link to Parameters, Connection, Declarations" translate="no">​</a></h3>
<p>If you&#x27;ve seen past posts from me, a lot of what I write I like to make very repeatable. To be honest, I do a lot of copying and pasting. But, it makes things easier for me, and I like to think easier for the people I work with when they look at our modules and functions and see repeatable code, rather than something crazy.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $uri = &quot;https://graph.microsoft.com/beta/deviceManagement/configurationSettings&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $Settings = (Invoke-MGGraphRequest -Method Get -Uri $uri).value</span><br></span></code></pre></div></div>
<p>Based off the connection above, I was able to find all the different operating system skus that are available on the Windows side in Intune. For this purposes (and most), I don&#x27;t really care too much about iOS, Android, or Mac, so I&#x27;m just including Windows based operating systems.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$settings.applicability.windowsskus</span><br></span></code></pre></div></div>
<p>This will give you the direct path to the full list of the WindowsSkus.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[CmdletBinding()]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Param(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        [Parameter(Mandatory = $True,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            HelpMessage = &quot;Choose from the following: All, windowsCloudN, windows11SE, iotEnterpriseSEval, windowsCPC, windowsEnterprise, windowsProfessional, windowsEducation, holographicForBusiness, windowsMultiSession, iotEnterprise&quot;)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        [ValidateSet(&#x27;All&#x27;, &#x27;windowsCloudN&#x27;, &#x27;windows11SE&#x27;, &#x27;windows11SE&#x27;, &#x27;iotEnterpriseSEval&#x27;, &#x27;windowsCPC&#x27;, &#x27;windowsEnterprise&#x27;, &#x27;windowsProfessional&#x27;, &#x27;windowsEducation&#x27;, &#x27;holographicForBusiness&#x27;, &#x27;windowsMultiSession&#x27;, &#x27;iotEnterprise&#x27;)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        [string]$Scope</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span></code></pre></div></div>
<p>As you can see above, I&#x27;m doing a ValidateSet and giving options on the different SKUs to choose from, or you can select All.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Microsoft Graph Connection check</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($null -eq (Get-MgContext)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Write-Error &quot;Authentication needed. Please connect to Microsoft Graph.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Break</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #region Declarations</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $FunctionName = $MyInvocation.MyCommand.Name.ToString()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $date = Get-Date -Format yyyyMMdd-HHmm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($outputdir.Length -eq 0) { $outputdir = $pwd }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $OutputFilePath = &quot;$OutputDir\$FunctionName-$date.csv&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $LogFilePath = &quot;$OutputDir\$FunctionName-$date.log&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $ResultsArray = @()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span></code></pre></div></div>
<p>This section is basically in all the code I have. In my profile, I have an $outputDir that I am setting, just a default path to dump all my files. If that is not present, than it will dump to present working directory.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="gathering-the-settings">Gathering the settings<a href="#gathering-the-settings" class="hash-link" aria-label="Direct link to Gathering the settings" title="Direct link to Gathering the settings" translate="no">​</a></h3>
<p>Now, we&#x27;re ready to gather the settings. Based on the $Scope above, I have a Switch statement, one that is looking for <strong>ALL</strong> the settings, and one looking for settings based on a specific SKU.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #region Gather the settings</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Switch ($Scope) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;All&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $uri = &quot;https://graph.microsoft.com/beta/deviceManagement/configurationSettings&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $Settings = (Invoke-MGGraphRequest -Method Get -Uri $uri).value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Default {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                $uri = &quot;https://graph.microsoft.com/beta/deviceManagement/configurationSettings?`$search=%22|||WindowsSkus=$Scope|||%22&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                $Settings = (Invoke-MGGraphRequest -Method Get -Uri $uri).value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Catch {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Write-Error &quot;Error gathering Settings: $_&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="building-the-object-outputting-the-results">Building the object, outputting the results<a href="#building-the-object-outputting-the-results" class="hash-link" aria-label="Direct link to Building the object, outputting the results" title="Direct link to Building the object, outputting the results" translate="no">​</a></h3>
<p>Now that we have the data, we can then build it into a PSCustomObject, and output the results. Nothing too crazy here, this is the data I found most intriguing, but there is a ton of information in the Graph API for this. Once that is done, we&#x27;re outputting the results to a CSV file to look at later.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#region Build Object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach ($item in $Settings) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $result = New-Object -TypeName PSObject -Property @{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Name                    = $item.Name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Keywords                = $item.Keywords -join &quot;; &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            RootDefinitionId        = $item.RootDefinitionId</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            DisplayName             = $item.DisplayName</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            HelpText                = $item.HelpText</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            OffsetURI               = $item.OffsetURI</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            InfoUrls                = $item.InfoUrls -join &quot;; &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            MinimumSupportedVersion = $item.applicability.MinimumSupportedVersion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WindowsSkus             = $item.applicability.WindowsSkus -join &quot;; &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $ResultsArray += $result</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #region Results</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($ResultsArray.Count -ge 1) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $ResultsArray | Sort-Object -Property DisplayName | Export-Csv -Path $OutputFilePath -NoTypeInformation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Test if output file was created</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (Test-Path $OutputFilePath) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Write-Output &quot;Output file = $OutputFilePath.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Write-Warning &quot;No output file created.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-data">The Data<a href="#the-data" class="hash-link" aria-label="Direct link to The Data" title="Direct link to The Data" translate="no">​</a></h2>
<p>I&#x27;ve uploaded the raw CSV file on my Github, along with some other files.</p>
<p><a href="https://github.com/Pacers31Colts18/Intune/blob/main/Export-IntuneConfigurationSettings-20250513-1630_All.csv" target="_blank" rel="noopener noreferrer" class="">CSV output for All</a>
<a href="https://github.com/Pacers31Colts18/Intune/blob/main/Export-IntuneConfigurationSettings-20250513-1628_multi-session.csv" target="_blank" rel="noopener noreferrer" class="">CSV output for Multi-Session</a></p>
<p>Initial count:</p>
<ul>
<li class="">16232 lines/settings for All</li>
<li class="">13288 lines/settings for Multi-Session</li>
<li class="">13739 lines/settings for Windows Enterprise</li>
</ul>
<p>Quite the difference, even between Multi-Session and Enterprise</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="cis-benchmarks">CIS Benchmarks<a href="#cis-benchmarks" class="hash-link" aria-label="Direct link to CIS Benchmarks" title="Direct link to CIS Benchmarks" translate="no">​</a></h3>
<p>The last bit of this post, is how this relates to CIS Benchmarks. When I first started looking at this, we were (and still) are on Enterprise v3.0.0. Since then, v4.0.0 has been released, along with v4.0.0 of the Intune benchmark. Rather than go back and re-work all the data, which was becoming to annoying for me. I&#x27;ve included three tabs, one for CIS Windows 11 Enterprise v3.0.0, one for CIS Windows 11 Enterprise v4.0.0 (only the new settings), and one for CIS Windows 11 Intune v4.0.0</p>
<p>The data for that can also be found on my <a href="https://github.com/Pacers31Colts18/Intune/blob/main/Intune_CISBenchmarks_MultiSession.xlsx" target="_blank" rel="noopener noreferrer" class="">GitHub</a></p>
<p>Breakdown of each tab:</p>
<ul>
<li class="">v3.0.0 Windows 11 Enterprise L1<!-- -->
<ul>
<li class="">61/384 settings are Intune configurable but not AVD Multi-Session scoped.<!-- -->
<ul>
<li class="">Intune configurable = Settings Catalog configurable, no custom ADMX, CSP, Remediation, etc.</li>
</ul>
</li>
<li class="">82/384 settings are not Intune configurable, meaning they are not an option in the Settings Catalog<!-- -->
<ul>
<li class="">Or they could be names I couldn&#x27;t find, looking at you One Drive instead of OneDrive!</li>
</ul>
</li>
<li class="">143/384 settings are not supported in Intune for AVD Multi-Session hosts</li>
</ul>
</li>
<li class="">v4.0.0 Windows 11 Enterprise L1<!-- -->
<ul>
<li class="">Like I said, a new benchmark released, so this tab is a little bit of a work in progress here.</li>
<li class="">3/31 settings are Intune configurable but not AVD Multi-Session scoped.</li>
<li class="">10/31 settings are not Intune configurable, meaning they are not an option in the Settings Catalog</li>
<li class="">13/31 settings  are not supported in Intune for AVD Multi-Session hosts (adding in the v3.0.0 settings to get the full picture)</li>
</ul>
</li>
</ul>
<p>Before I go too much further, I do want to recognize that CIS says the Intended Audience for these benchmarks are:</p>
<p><img decoding="async" loading="lazy" alt="CIS Guidance" src="/assets/images/win11_guidance-f390ad882f251527a59d7d033f1e98f4.png" width="1274" height="451" class="img_ev3q"></p>
<p>We&#x27;re in this situation where we have multiple forests, hybrid joined, and no longer wish to manage our settings with Group Policy. Due to regulations, we also need to adhere to IRS config standards, which use the Enterprise benchmarks. I don&#x27;t believe we&#x27;re the only ones out there doing this, as Microsoft&#x27;s stance has been to push users towards Intune management rather than Group Policy management, so this is the pickle we are in.</p>
<p><em>Mini disclaimer over</em></p>
<p>For work purposes, the Enterprise benchmarks is all I really care about, but for everyone else, I wanted to provide the Intune benchmark data also.</p>
<ul>
<li class="">v4.0.0 Microsoft Intune for Windows 11<!-- -->
<ul>
<li class="">86/337 settings/lines are Intune configurable but not AVD Multi-session scoped.</li>
<li class="">16/337 settings are not Intune configurable, meaning they are not an option in the Settings Catalog.<!-- -->
<ul>
<li class="">Note: These are named properly from CIS, where the Enterprise uses Group Policy naming convention.<!-- -->
<ul>
<li class="">Next rant: You think they could standardize the naming scheme for us between GPO and Intune? That&#x27;d be super neat.</li>
</ul>
</li>
</ul>
</li>
<li class="">102/337 settings are not supported in Intune for AVD Multi-Session Hosts</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="big-takeways">Big Takeways<a href="#big-takeways" class="hash-link" aria-label="Direct link to Big Takeways" title="Direct link to Big Takeways" translate="no">​</a></h3>
<ul>
<li class="">For some reason, User Rights Assignments aren&#x27;t supported. Why? Beats me. It seems like you would want these to be configurable, but maybe I am missing something.</li>
<li class="">ASR Rules aren&#x27;t supported. I&#x27;m assuming you just wouldn&#x27;t want processes to start getting blocked on these and locking users out?</li>
<li class="">Services, not Intune supported at all, but maybe one day?</li>
<li class="">The rest seem like random settings to me. I don&#x27;t really see a rhyme or reason really to why some would be supported, but some aren&#x27;t. Example: Allow Cortana = Supported. Allow Cortana Above Lock = Not Supported</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion" translate="no">​</a></h2>
<p>Really, this was more of an awareness post more than anything. I think a lot of us are new to the AVD/VDI/Virtual world, coming mainly from a physical workstation side of the house. I&#x27;ve touched Citrix, but it&#x27;s been many years ago. With Intune and now Microsoft having AVD, it seems orgs are sort of combining the teams and hoping to set the policies the same as a workstation. To me it makes total sense to go this route, but there are some catches and things to consider, especially with Intune. Hopefully this will help someone else out, and be able to catch settings not applying more easily.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Intune related posts." class="tag_zVej tagRegular_sFm0" href="/blog/tags/intune">Intune</a></li><li class="tag_QGVx"><a rel="tag" title="Center for Internet Security related posts." class="tag_zVej tagRegular_sFm0" href="/blog/tags/cis">CIS</a></li><li class="tag_QGVx"><a rel="tag" title="Azure Virtual Desktop related posts." class="tag_zVej tagRegular_sFm0" href="/blog/tags/avd">AVD</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2025-05-13-cis-benchmarks-avd-multisession/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/configurationitems-to-remediationscripts"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Converting Registry Based SCCM Configuration Items to Intune Remediation Scripts</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/entra-grouprandomization"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Creating Intune Randomized Rollouts with Entra Group Membership</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#graph-api-for-the-win" class="table-of-contents__link toc-highlight">Graph API for the win</a></li><li><a href="#walking-through-the-script" class="table-of-contents__link toc-highlight">Walking through the script</a><ul><li><a href="#parameters-connection-declarations" class="table-of-contents__link toc-highlight">Parameters, Connection, Declarations</a></li><li><a href="#gathering-the-settings" class="table-of-contents__link toc-highlight">Gathering the settings</a></li><li><a href="#building-the-object-outputting-the-results" class="table-of-contents__link toc-highlight">Building the object, outputting the results</a></li></ul></li><li><a href="#the-data" class="table-of-contents__link toc-highlight">The Data</a><ul><li><a href="#cis-benchmarks" class="table-of-contents__link toc-highlight">CIS Benchmarks</a></li><li><a href="#big-takeways" class="table-of-contents__link toc-highlight">Big Takeways</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="footer-icons">
                  <a href="https://github.com/pacers31colts18" class="footer-icon footer-icon-github" target="_blank" rel="noopener noreferrer"></a>
                  <a href="https://linkedin.com/in/joe-loveless" class="footer-icon footer-icon-linkedin" target="_blank" rel="noopener noreferrer"></a>
                  <a href="https://bsky.app/profile/joeloveless.com" class="footer-icon footer-icon-bluesky" target="_blank" rel="noopener noreferrer"></a>
                  <a href="https://infosec.exchange/@Pacers31Colts18" class="footer-icon footer-icon-mastodon" target="_blank" rel="noopener noreferrer"></a>
                  <a href="mailto:joe@joeloveless.com" class="footer-icon footer-icon-email"></a>
                  <a href="https://joeloveless.com/index.xml" class="footer-icon footer-icon-rss" target="_blank" rel="noopener noreferrer"></a>
                </div>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2026 Joe Loveless</div></div></div></footer></div>
</body>
</html>