<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-blog" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Converting Registry Based SCCM Configuration Items to Intune Remediation Scripts | Joe Loveless</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://joeloveless.com/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://joeloveless.com/img/social-card.png"><meta data-rh="true" property="og:url" content="https://joeloveless.com/blog/configurationitems-to-remediationscripts"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Converting Registry Based SCCM Configuration Items to Intune Remediation Scripts | Joe Loveless"><meta data-rh="true" name="description" content="Script walkthrough on converting SCCM Configuration Items to Intune Remediation Scripts."><meta data-rh="true" property="og:description" content="Script walkthrough on converting SCCM Configuration Items to Intune Remediation Scripts."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-05-24T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="Intune,SCCM,PowerShell"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://joeloveless.com/blog/configurationitems-to-remediationscripts"><link data-rh="true" rel="alternate" href="https://joeloveless.com/blog/configurationitems-to-remediationscripts" hreflang="en"><link data-rh="true" rel="alternate" href="https://joeloveless.com/blog/configurationitems-to-remediationscripts" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://joeloveless.com/blog/configurationitems-to-remediationscripts","mainEntityOfPage":"https://joeloveless.com/blog/configurationitems-to-remediationscripts","url":"https://joeloveless.com/blog/configurationitems-to-remediationscripts","headline":"Converting Registry Based SCCM Configuration Items to Intune Remediation Scripts","name":"Converting Registry Based SCCM Configuration Items to Intune Remediation Scripts","description":"Script walkthrough on converting SCCM Configuration Items to Intune Remediation Scripts.","datePublished":"2025-05-24T00:00:00.000Z","author":[],"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://joeloveless.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Joe Loveless RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Joe Loveless Atom Feed">




<script defer="defer" src="https://cloud.umami.is/script.js" data-website-id="50771638-05b4-4125-a8fd-c8e7e72e57e5"></script><link rel="stylesheet" href="/assets/css/styles.6017bd90.css">
<script src="/assets/js/runtime~main.c47716cd.js" defer="defer"></script>
<script src="/assets/js/main.b6d85e87.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/blog/tags">Tags</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/expanding-my-homelab-with-cloudflare-tailscale-and-more">Expanding my Home Lab with Cloudflare, Tailscale, and more</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tracking-chores-with-home-assistant">Tracking Chores with Home Assistant</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/what-settings-are-in-intune">What Group Policy Settings aren&#x27;t in Microsoft Intune?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/exploring-microsoft-intune-filters">Exploring Microsoft Intune Filters</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/making-dexcom-better-wtih-homeassistant">Making Dexcom better with Home Assistant Voice</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Converting Registry Based SCCM Configuration Items to Intune Remediation Scripts</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-05-24T00:00:00.000Z">May 24, 2025</time> · <!-- -->10 min read</div></header><div id="__blog-post-container" class="markdown"><p>A PowerShell script walkthrough on converting SCCM Configuration Items to Intune Remediation Scripts.</p>
<p>It&#x27;s Memorial Day Weekend here in the States, which means it&#x27;s Indy 500 Weekend. It also means my Indiana Pacers are up 2-0 on the New York Knicks. If you know me, I&#x27;m a huge Pacers fan. With that comes a hatred for the Knicks, so right now I am giddy. Game 3 is tomorrow in Indianapolis, and the same day as the Indy 500. Back in Indy, we call that Racers and Pacers Weekend. I don&#x27;t miss Indiana much for anything at all, but events like this, I do miss. Indianapolis knows how to do sporting weekends right. Without being back in Indy, my family and I will most likely be cooking some hot dogs, eating some s&#x27;mores, and burning all the downed sticks and brush from the recent storms. My daughter is also looking into getting into mountain biking, so I have been going down the internet rabbit hole looking for a decently priced mountain bike.</p>
<p>I&#x27;ve had this idea on my mind, and asked Steve Jesok the question at MMS during his session on Intune Remediation Scripts and SCCM Configuration Items. &quot;Does anyone have a way to convert registry based configuration items to Intune Remedation Scripts? Steve was unaware of anything out there. I&#x27;m also not entirely sure how useful this would be for admins out there. If already using PowerShell based detection and remediation in SCCM, this isn&#x27;t really applicable. If you&#x27;re using the &quot;GUI method&quot; of looking for a registry key, and then remediating off of that, then this post might be for you.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-is-a-remediation-script">What is a Remediation Script?<a href="#what-is-a-remediation-script" class="hash-link" aria-label="Direct link to What is a Remediation Script?" title="Direct link to What is a Remediation Script?" translate="no">​</a></h2>
<p><a href="https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/remediations" target="_blank" rel="noopener noreferrer" class="">Intune Remediations - Microsoft Learn</a>. Simply put, a Remediation Script is a &quot;detection&quot; and a &quot;remediation&quot;. If the detection script detects the state is not correct (Non-Compliant), it will then go onto the Remediation portion.</p>
<p>With Intune, we do have a limit of 200 remediation scripts, which compared to SCCM, is quite small. I like to think of a Remediation Script as being equal to a Configuration Baseline. I don&#x27;t think we should be doing single actions necessarily, but combining like actions together. In this post, I&#x27;ll be combining Services together, where I&#x27;ll want to set multiple Windows Services to a Disabled status.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-do-you-mean-by-gui-method">What do you mean by &quot;GUI Method&quot;?<a href="#what-do-you-mean-by-gui-method" class="hash-link" aria-label="Direct link to What do you mean by &quot;GUI Method&quot;?" title="Direct link to What do you mean by &quot;GUI Method&quot;?" translate="no">​</a></h2>
<p><img decoding="async" loading="lazy" src="/assets/images/sccm_gui_method-510429092d035182fba7a6eeb122e4c6.png" title="GUI Method" width="651" height="619" class="img_ev3q"></p>
<p>Anything that&#x27;s not script based using Powershell/VBScript/etc, but configurable through the GUI.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="pre-requisites">Pre-Requisites<a href="#pre-requisites" class="hash-link" aria-label="Direct link to Pre-Requisites" title="Direct link to Pre-Requisites" translate="no">​</a></h2>
<p>I&#x27;ve added all the files needed for this on my GitHub page.</p>
<ul>
<li class=""><a href="https://github.com/Pacers31Colts18/Intune/blob/main/Intune-Registry-Detect.ps1" target="_blank" rel="noopener noreferrer" class="">Intune Detection Template</a></li>
<li class=""><a href="https://github.com/Pacers31Colts18/Intune/blob/main/Intune-Registry-Detect.ps1" target="_blank" rel="noopener noreferrer" class="">Intune Remediation Template</a></li>
<li class=""><a href="https://github.com/Pacers31Colts18/Intune/blob/main/Convert-CMConfigurationItemtoIntuneRemediationScript.ps1" target="_blank" rel="noopener noreferrer" class="">Convert Configuration Items to Remediation Script</a></li>
</ul>
<h1>Walkthrough</h1>
<p>Before getting too far into this, my method only works with the templates above for an Intune Detection and Remediation Script. What we&#x27;re doing is taking these template files, and then doing some manipulation with PowerShell. Working on a team of 6 other engineers, we&#x27;re trying our best to have repeatable practices, and make the code readable for everyone else. By having a template, this makes things much easier for us to know what is going on. The long-term goal is to also combine this with GitHub Actions and have a repository of code that requires code review and a more DevOps mindset. We&#x27;re not 100% there yet, but we&#x27;re working our way to that goal.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="intune-detection-and-remediation-template">Intune Detection and Remediation Template<a href="#intune-detection-and-remediation-template" class="hash-link" aria-label="Direct link to Intune Detection and Remediation Template" title="Direct link to Intune Detection and Remediation Template" translate="no">​</a></h2>
<p>I feel like these are pretty self explanatory. As I said earlier, we&#x27;re thinking of this as more of a Configuration Baseline mindset, where you combine multiple Configuration Items into a Baseline. We&#x27;re trying our best to not have a single script doing one single purpose (although there are use cases for that). With a large environment, we&#x27;re trying to avoid the unknown of the future with a 200 script limit.</p>
<p>By having a PowerShell array for the registry key detection, we&#x27;re able to achieve this with this method.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="converting-configuration-items-to-remediation-scripts">Converting Configuration items to Remediation Scripts<a href="#converting-configuration-items-to-remediation-scripts" class="hash-link" aria-label="Direct link to Converting Configuration items to Remediation Scripts" title="Direct link to Converting Configuration items to Remediation Scripts" translate="no">​</a></h2>
<p>I like to try to walk through what I am doing, mainly to kinda serve as a way to document my thoughts and what the heck I was doing. But hopefully people are finding this useful also. I don&#x27;t consider myself to be the best at this by any means, so hopefully my stumbling explanations will serve somebody out there!</p>
<p>A couple thoughts before I go into the code:</p>
<ul>
<li class="">I&#x27;ve started using CoPilot to provide the comment-based help in my code. Freaking amazing. Such a time saver, highly recommended.</li>
<li class="">I hate the name of this function. Any suggestions?</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="parameter-block">Parameter Block<a href="#parameter-block" class="hash-link" aria-label="Direct link to Parameter Block" title="Direct link to Parameter Block" translate="no">​</a></h3>
<p>At the beginning of the function is the parameters. You can input multiple configuration items through an array, or you can provide no configuration item and get a Out-GridView that will allow you to multi-select Configuration Items. We also have a ValidateSet that will allow you to choose if you only want a Detection Method, or a Remediation, or both. I don&#x27;t really know why you would just want a Remediation Script, but maybe you already have a Detection Method in place? By default, it&#x27;s going to default to both a Detection and Remediation Script.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    [CmdletBinding()]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Param(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        [Parameter(Mandatory = $False)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        [array]$configurationItem,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        [Parameter(Mandatory = $False)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        [ValidateSet(&quot;Detection&quot;, &quot;Remediation&quot;, &quot;Detection/Remediation&quot;)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $scriptType = &quot;Detection/Remediation&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="authentication-declarations">Authentication, Declarations<a href="#authentication-declarations" class="hash-link" aria-label="Direct link to Authentication, Declarations" title="Direct link to Authentication, Declarations" translate="no">​</a></h3>
<p>I&#x27;m capturing the present working directory ($pwd) to put the location back to once the function is finished. We&#x27;re also providing authentication to CM, as you will need access to CM to pull the Configuration Items. After that, my declarations are very repeatable, but the last 4 lines are customizable to fit your needs.</p>
<p>$templateDetectionScript and $templateRemediationScript should be the files on my GitHub, just change to the location that fits for you. $OutputDetectionScript and $OutputRemediationScript are where the files will be saved to, with the name of the function and the date ran.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$StartingLocation = $pwd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #region ConfigMgr Authentication</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $SiteCode = &quot;JL1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Import-Module &quot;$($ENV:SMS_ADMIN_UI_PATH)\..\ConfigurationManager.psd1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Set-Location &quot;$SiteCode`:&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #region Declarations</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $FunctionName = $MyInvocation.MyCommand.Name.ToString()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $date = Get-Date -Format yyyyMMdd-HHmm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($outputdir.Length -eq 0) { $outputdir = $pwd }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $OutputFilePath = &quot;$OutputDir\$FunctionName-$date.csv&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $LogFilePath = &quot;$OutputDir\$FunctionName-$date.log&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $templateDetectionScript = &quot;C:\Users\jlove\test\Intune-Registry-Detect.ps1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $templateRemediationScript = &quot;C:\Users\jlove\test\Intune-Registry-Remediate.ps1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $OutputDetectionScript = &quot;$OutputDir\detect_$FunctionName-$date.ps1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $OutputRemediationScript = &quot;$OutputDir\remediate_$FunctionName-$date.ps1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $ResultsArray = @()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="gathering-the-configuration-items">Gathering the Configuration Items<a href="#gathering-the-configuration-items" class="hash-link" aria-label="Direct link to Gathering the Configuration Items" title="Direct link to Gathering the Configuration Items" translate="no">​</a></h3>
<p>In the first part, if you do not input a configuration item in the parameter block, you&#x27;ll get a popup from Out-GridView allowing you to multi-select configuration items. I forget who I found this little trick through, but I&#x27;ve been trying to put the Out-GridView selection into everything I do since then. I find it to be so helpful. If you did input configuration items in the parameter block, then we are doing a search for those configuration items, and then adding them to an array.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #region Configuration Items</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($null -eq $configurationItem) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $resolvedConfigurationItems = (Get-CMConfigurationItem -Name * -Fast | </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Select-Object DateLastModified, InUse, LocalizedDescription, LocalizedDisplayName, ObjectPath |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Out-GridView -PassThru).LocalizedDisplayName</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $resolvedConfigurationItems = @()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        foreach ($item in $configurationItem) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $resolvedItem = (Get-CMConfigurationItem -Name $item -Fast).LocalizedDisplayName</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if ($resolvedItem) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                $resolvedConfigurationItems += $resolvedItem</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Write-Warning &quot;Could not resolve configuration item: $item&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="building-the-configuration-items-for-conversion">Building the Configuration Items for Conversion<a href="#building-the-configuration-items-for-conversion" class="hash-link" aria-label="Direct link to Building the Configuration Items for Conversion" title="Direct link to Building the Configuration Items for Conversion" translate="no">​</a></h3>
<p>With how the data is stored in CM, I found I had to do some manipulation to then get it to work with PowerShell.</p>
<ul>
<li class="">For the $complianceRules section, in our environment we are looking for a &quot;Value&quot; and checking to make sure the item &quot;Exists&quot;. Because of that, I only wanted to grab what is a value, so I put a Where-Object on this.</li>
<li class="">Similar with $complianceSettings, I don&#x27;t want to grab anything that&#x27;s already a script, just anything where the sourceType = Registry. If it&#x27;s not Registry-based, I&#x27;m simply skipping over all of that. There are other ways to export those scripts.</li>
<li class="">Switch is somewhat new to me, and I&#x27;ve been trying to use that more also. CM stores the items as Int64, String, and StringArray (amongst some others), but using PowerShell, they need to be DWORD, STRING, MULTISTRING, so I am converting to that format.</li>
<li class="">I also need to change HKEY_LOCAL_MACHINE to HKLM: and HKEY_CURRENT_USER to HKCU:.</li>
<li class="">Once all the data is manipulated how I want, I&#x27;m adding everything to a PSCustomObject, and then storing in a $ResultsArray.</li>
</ul>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#region Compliance Rules/Compliance Settings</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach ($item in $resolvedConfigurationItems) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Write-Output &quot;Processing configuration item: $item&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $complianceRules = Get-CMComplianceRule -Name $item -WarningAction Ignore | </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Where-Object { $_.expression.operands.methodtype -eq &quot;Value&quot; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $complianceSettings = Get-CMComplianceSetting -Name $item -WarningAction Ignore | </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Where-Object { $_.sourceType -eq &quot;Registry&quot; } | Select-Object -Unique</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (!$complianceSettings) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Write-Warning &quot;Configuration Item &#x27;$item&#x27; is not Registry-based. Skipping...&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            continue</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        foreach ($rule in $complianceRules) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            foreach ($setting in $complianceSettings) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                $settingdatatypeName = switch ($setting.settingdataType.Name) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    &quot;Int64&quot; { &quot;DWORD&quot; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    &quot;String&quot; { &quot;STRING&quot; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    &quot;StringArray&quot; { &quot;MULTISTRING&quot; }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    default { $setting.settingdataType.Name }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                $settingLocation = $setting.location -replace &#x27;^HKEY_LOCAL_MACHINE&#x27;, &#x27;HKLM:&#x27; -replace &#x27;^HKEY_CURRENT_USER&#x27;, &#x27;HKCU:&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                $result = New-Object -TypeName PSObject -Property @{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    RuleValue       = $($rule.expression.operands.Value)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    SettingDataType = $settingdatatypeName</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    SettingPath     = $settingLocation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    SettingName     = $($setting.ValueName)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                $ResultsArray += $result</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($ResultsArray.Count -eq 0) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Write-Warning &quot;No registry-based configuration settings found in any selected Configuration Items.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="building-the-registry-keys">Building the Registry Keys<a href="#building-the-registry-keys" class="hash-link" aria-label="Direct link to Building the Registry Keys" title="Direct link to Building the Registry Keys" translate="no">​</a></h3>
<p>In this region, we&#x27;re simply taking the results from the $ResultsArray and converting to the format needed in the Detection and Remediation Scripts.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#region Build RegistryKeys content</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $registryKeysContent = @()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $registryKeysContent += &quot;`$RegistryKeys = @(&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    foreach ($result in $ResultsArray) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $registryKeysContent += &quot;    @{ Path = `&quot;$($result.SettingPath)`&quot;; Name = `&quot;$($result.SettingName)`&quot;; Type = `&quot;$($result.SettingDataType)`&quot;; Value = `&quot;$($result.RuleValue)`&quot; }&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $registryKeysContent += &quot;)&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="modifying-the-templates-saving-the-new-files">Modifying the templates, saving the new files.<a href="#modifying-the-templates-saving-the-new-files" class="hash-link" aria-label="Direct link to Modifying the templates, saving the new files." title="Direct link to Modifying the templates, saving the new files." translate="no">​</a></h3>
<ul>
<li class="">The IndexOf, we&#x27;re looking for the correct lines in the detection and remediation script, and if not, we&#x27;re leaving those sections as is. In simple terms, we&#x27;re only looking to modify a certain block of text in the two template files, and add on to it with whatever is in the ResultsArray.</li>
<li class="">Once all that is finished, we&#x27;re then saving as a new PowerShell file, with the right encoding.</li>
<li class="">We have checks from the parameter block looking for either Detection, Remediation, or both.</li>
</ul>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #region Detection Script</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($scriptType -eq &quot;Detection&quot; -or $scriptType -eq &quot;Detection/Remediation&quot;) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $detectiontemplateLines = Get-Content $templateDetectionScript</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $detectionstartIndex = $detectiontemplateLines.IndexOf(&#x27;$RegistryKeys = @(&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $detectionendIndex = $detectiontemplateLines.IndexOf(&#x27;)&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if ($detectionstartIndex -eq -1 -or $detectionendIndex -eq -1) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Write-Warning &quot;Could not find `$RegistryKeys block in the detection template. Check formatting.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $detectionnewContent = @()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $detectionnewContent += $detectiontemplateLines[0..($detectionstartIndex - 1)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $detectionnewContent += $registryKeysContent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $detectionnewContent += $detectiontemplateLines[($detectionendIndex + 1)..($detectiontemplateLines.Length - 1)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $detectionnewContent | Out-File $OutputDetectionScript -Encoding utf8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Write-Output &quot;Detection script saved as: $OutputDetectionScript&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #region Remediation Script</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($scriptType -eq &quot;Remediation&quot; -or $scriptType -eq &quot;Detection/Remediation&quot;) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $remediationtemplateLines = Get-Content $templateRemediationScript</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $remediationstartIndex = $remediationtemplateLines.IndexOf(&#x27;$RegistryKeys = @(&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $remediationendIndex = $remediationtemplateLines.IndexOf(&#x27;)&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if ($remediationstartIndex -eq -1 -or $remediationendIndex -eq -1) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Write-Warning &quot;Could not find `$RegistryKeys block in the remediation template. Check formatting.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $remediationnewContent = @()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $remediationnewContent += $remediationtemplateLines[0..($remediationstartIndex - 1)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $remediationnewContent += $registryKeysContent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $remediationnewContent += $remediationtemplateLines[($remediationendIndex + 1)..($remediationtemplateLines.Length - 1)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            $remediationnewContent | Out-File $OutputRemediationScript -Encoding utf8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Write-Output &quot;Remediation script saved as: $OutputRemediationScript&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Set-Location $StartingLocation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="script-example">Script Example<a href="#script-example" class="hash-link" aria-label="Direct link to Script Example" title="Direct link to Script Example" translate="no">​</a></h2>
<p>In my example, I have a set of Configuration Items that are setting Windows Services to Disabled in the registry. I&#x27;m wanting to take those, and convert them to an Intune Remediation Script.</p>
<p>I ran the function without inputting any configuration items, or choosing what method I want. Who is to remember the names of these anyways?</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA30AAADgCAIAAAA4+JjuAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAASdEVYdFNvZnR3YXJlAEdyZWVuc2hvdF5VCAUAAAqeSURBVHhe7dwxcpzYGobhWYaTmzhTqFCx1uC9KPFCnCr0HrrKC5ioN9ErUD7V0NBw+KFpSf7mzszzlAILH+Ac0C3eoeX7xxcAAPj9/mg3AADAb6A7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgIR/and+//nnrx/f2q180Ovj29tz9/V0eLlsO749v50ehu/S/t6zU3o9Pp8O/xu//eA9+uDuH/T3nh3gv2ZPd37/+efEz+/l9uvmhXr/1XLshtd/NfHtx6+bY7ZVjRXTPLm3NPN8eTi9Xfd9PT6/vT2+liPvd3x7Pl6ONdsYeDCvXZB3n/1w6i/F5Wt6xcoT7bRz97Wzl3Yec7/Z2Y9f27/+sPd159oyd+5eOu87fC1/dPfYefa1yQNwl73dOdTitx+/+m/Of7g7/KZHKruzG/Bj16HPE2hj9/vPxabay+FpGmeH4+0Hz+fa+RhbzvMcl6en0xATx9PTqevO5ci7V3Qu2iFh43ZekHsdTu1hP3iiu3Zfnr101zH3OJyuEXa8Vb3v8L4Jv2+vDTsv76f49MkD/Dfd252X796Xnbe68/vPbkt17O4laNOUxRG6LG43FsoXe7PXJ8MrkMPp6fDyddjeZdn5teKkzybfXt8zDV3YP666KLy8khn/vOeNVDHP18e348PhdJnJ8fXrscvNYmRn14p6zbouLVvMcPqSqY/daeic9+rGL9feu16lbkprF+T22W+uaJ4maycqbtzlInerez2/YD6fa3335ZTGw05jZTnPtWOW13O5+3iWZj7T3adzaEeWyyxHNhuHll27R4lbfP7PpJX3+tcX/5d5lj+K5dmXJ1qbPADv8N7u7AtvT+JN3ejOi73duXKIcujMIrB67RN6KIDxPeI4YBp508yaPvjHB974oDqPHJ6ju16flPM8t8LXl8PT8fXL6/Hx9cu5O+uRu1e0/WQdF9i7LrP7xL+/DmUnlWt/OTxeX8pOprd2QZqz71xROb63PFFx47pw6a5wHx+XuC93L6e0/KuNeZbHXF7Pcvdi8tPdJ/eoGLmyzGLkfPdmws09it3i6car86LajeWPYm959nH3jSUD8D73duf5z2Pr9e15R36+vztr1Wftw/aNQ5SV1mwcPnQuC2D6rOpekJz/cGzeHXbPtvOja3zITT7I3vUYq+Z5OfXLw+n4eOzmsNqd96yoGD9oHszT5i5Cp+nOau2j6ZHXLsjWDG+uaB4xveWJljduevv6wavduTKl3rI7y3m2x1wZWW5cTv7lEk/917XAliPXllmMnK9ruzuntpfZ+8gtPv958l5zec17Gz+Kyx+Y8UTj9dmYPAB32dudo6Lm+vys+q/12d25Fp6XIC7+plMG1uQZc7b9wBsfXS8Pp36v7sXS7JXh/IneKLbPjtAdvJrnskIOp/Xu3L+ildO1Y/qmuV6E6yuo5TGLNbbLvP0+qZ3hXSuqKqQ9UXXj1oKs2H1lSr3f3p3V5PvuHH42hiNXI8tl1iPv6s7sLR6GXU5U/sLJ2qmXR2u7c1j1xhEA2G9vd64lXG9vKX56d1aHuf05e/eUah9OTXUN36498PrtL4enyXO9iLa1x9Xa9plqntczDg6n53LkvStqxw+aB/PlI8vua5xJecxyjdN/5rLdXr2tGd5c0aL8ihOVN64KstXurKbUi3TnYvLTkeN8ypHVMuuR93Rn+BZfN86be2rt1Mujtd3pfSfAp/qU7uxeL66O+Pbj5yUMZwdaBuOg6s71mJwfZ/Z7AOuGX2i76P/19/R5uf0Jcv/n0+Hr5d/3DLssH4drj6vxMbmtmGfVnZNf0ZuMvHNF7SN/MBtTRsk0sM4HuVyHcu3X11GTd1QbF2SjaW6vaDqxwfJExY2rgqzvzuXu5ZTWvi3nuTxmeT3L3YvJz0dOr1I7cmWZxcjJjTufev5v5Jf3KHmLx5H9xm567Y9o+aPYW/7AjCdqA7qaPAB3eW93zj57X/71XPl7oM0Rfv2YjLtuHMavd+f0s/bd/z9KQ9L1X9PfgWs/HNx44J0Hz59/k9+ruzyxNh5418GLh+hUM8/lAccZfnRFi+6cLmc8wvR957U/xo9WTw+vwzGXUx2rpft6PCwe+dMTlWffv6Jm96b/lkeYjVwJsnbw5pSWZy/n2Y7vN1bXc233dvLzkd1tvf46xM5ltiPHAu5mOP7HT3mPQrd4nM985HwCW/8zLM9eLHw5fnIuAO6ypzv/762/OuWTNe87z99egwz+6WbJDsBn+1d0JzHzd6LlZ5rwz6U7AX4r3cl95p+zi07+VXQnwG+lOwEASLjdnfN/6XPRDgIAgE26EwCABN0JAECC7gQAIEF3AgCQoDsBAEjQnQAAJOhOAAASdCcAAAm6EwCABN0JAECC7gQAIEF3AgCQoDsBAEjQnQAAJOhOAAASdCcAAAm3uxMAAD5OdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkKA7AQBI0J0AACToTgAAEnQnAAAJuhMAgATdCQBAgu4EACBBdwIAkPAXbZ76xJ8pjAIAAAAASUVORK5CYII=" title="Example" width="893" height="224" class="img_ev3q"></p>
<p>I am now prompted to select what Configuration Items I want to include. I want all of them that are Services</p>
<p><img decoding="async" loading="lazy" src="/assets/images/out-gridview-a485a420b43318c9be83c1c0b10ec5f5.png" title="Out-Gridview" width="1056" height="601" class="img_ev3q"></p>
<p>I want some pretty output telling me what is happening</p>
<p><img decoding="async" loading="lazy" src="/assets/images/example2-6f59c017895e46d451e2ffa735f72e3f.png" title="Output" width="586" height="229" class="img_ev3q"></p>
<p>I now have both a Detection and Remediation Script!</p>
<p><img decoding="async" loading="lazy" src="/assets/images/example_detection-c56b7271399c49e3b8ade9049cbad5a1.png" title="Detection Script" width="1319" height="795" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/example_remediation-1db124b932d8759e4fe83aab256ce958.png" title="Remediation Script" width="1169" height="522" class="img_ev3q"></p>
<h1>Conclusion</h1>
<p>Next step would be to tie this all to a GitHub Action, and have this upload to Intune, following proper code review using branch protection. Again, maybe you already had PowerShell scripts in CM. You were more thoughtful than me (we are about 50/50). If not, you now have a way to convert those more easily.</p>
<p>Have a great weekend everyone! GO PACERS</p>
<p><img decoding="async" loading="lazy" src="/assets/images/tyrese-ee7fb803e90565c0decca498c3f9dddf.jpeg" title="Tyrese Haliburton" width="654" height="436" class="img_ev3q"></p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Intune related posts." class="tag_zVej tagRegular_sFm0" href="/blog/tags/intune">Intune</a></li><li class="tag_QGVx"><a rel="tag" title="System Center Configuration Manager related posts." class="tag_zVej tagRegular_sFm0" href="/blog/tags/sccm">SCCM</a></li><li class="tag_QGVx"><a rel="tag" title="PowerShell related posts." class="tag_zVej tagRegular_sFm0" href="/blog/tags/powershell">PowerShell</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2025-05-24-converting-configurationitems-to-remediationscripts/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/cis-benchmarks-enterprise-win11"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Examining CIS Microsoft Windows 11 Enterprise Benchmark in a Hybrid Environment</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/cis-benchmarks-avd-multisession"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">CIS L1 Benchmarks in Intune with AVD Multi-Session Hosts</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-a-remediation-script" class="table-of-contents__link toc-highlight">What is a Remediation Script?</a></li><li><a href="#what-do-you-mean-by-gui-method" class="table-of-contents__link toc-highlight">What do you mean by &quot;GUI Method&quot;?</a></li><li><a href="#pre-requisites" class="table-of-contents__link toc-highlight">Pre-Requisites</a></li><li><a href="#intune-detection-and-remediation-template" class="table-of-contents__link toc-highlight">Intune Detection and Remediation Template</a></li><li><a href="#converting-configuration-items-to-remediation-scripts" class="table-of-contents__link toc-highlight">Converting Configuration items to Remediation Scripts</a><ul><li><a href="#parameter-block" class="table-of-contents__link toc-highlight">Parameter Block</a></li><li><a href="#authentication-declarations" class="table-of-contents__link toc-highlight">Authentication, Declarations</a></li><li><a href="#gathering-the-configuration-items" class="table-of-contents__link toc-highlight">Gathering the Configuration Items</a></li><li><a href="#building-the-configuration-items-for-conversion" class="table-of-contents__link toc-highlight">Building the Configuration Items for Conversion</a></li><li><a href="#building-the-registry-keys" class="table-of-contents__link toc-highlight">Building the Registry Keys</a></li><li><a href="#modifying-the-templates-saving-the-new-files" class="table-of-contents__link toc-highlight">Modifying the templates, saving the new files.</a></li></ul></li><li><a href="#script-example" class="table-of-contents__link toc-highlight">Script Example</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="footer-icons">
                  <a href="https://github.com/pacers31colts18" class="footer-icon footer-icon-github" target="_blank" rel="noopener noreferrer"></a>
                  <a href="https://linkedin.com/in/joe-loveless" class="footer-icon footer-icon-linkedin" target="_blank" rel="noopener noreferrer"></a>
                  <a href="https://bsky.app/profile/joeloveless.com" class="footer-icon footer-icon-bluesky" target="_blank" rel="noopener noreferrer"></a>
                  <a href="https://infosec.exchange/@Pacers31Colts18" class="footer-icon footer-icon-mastodon" target="_blank" rel="noopener noreferrer"></a>
                  <a href="mailto:joe@joeloveless.com" class="footer-icon footer-icon-email"></a>
                  <a href="https://joeloveless.com/blog/rss.xml" class="footer-icon footer-icon-rss" target="_blank" rel="noopener noreferrer"></a>
                </div>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2026 Joe Loveless</div></div></div></footer></div>
</body>
</html>