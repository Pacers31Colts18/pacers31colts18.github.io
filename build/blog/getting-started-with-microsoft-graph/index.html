<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-blog" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Getting Started with Microsoft Graph | Joe Loveless</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://joeloveless.com/img/social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://joeloveless.com/img/social-card.jpg"><meta data-rh="true" property="og:url" content="https://joeloveless.com/blog/getting-started-with-microsoft-graph"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Getting Started with Microsoft Graph | Joe Loveless"><meta data-rh="true" name="description" content="A guide to Microsoft Graph"><meta data-rh="true" property="og:description" content="A guide to Microsoft Graph"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-07-13T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="PowerShell,Graph API"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://joeloveless.com/blog/getting-started-with-microsoft-graph"><link data-rh="true" rel="alternate" href="https://joeloveless.com/blog/getting-started-with-microsoft-graph" hreflang="en"><link data-rh="true" rel="alternate" href="https://joeloveless.com/blog/getting-started-with-microsoft-graph" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://joeloveless.com/blog/getting-started-with-microsoft-graph","mainEntityOfPage":"https://joeloveless.com/blog/getting-started-with-microsoft-graph","url":"https://joeloveless.com/blog/getting-started-with-microsoft-graph","headline":"Getting Started with Microsoft Graph","name":"Getting Started with Microsoft Graph","description":"A guide to Microsoft Graph","datePublished":"2025-07-13T00:00:00.000Z","author":[],"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://joeloveless.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Joe Loveless RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Joe Loveless Atom Feed">




<script defer="defer" src="https://cloud.umami.is/script.js" data-website-id="50771638-05b4-4125-a8fd-c8e7e72e57e5"></script><link rel="stylesheet" href="/assets/css/styles.77ea03e4.css">
<script src="/assets/js/runtime~main.04602d8d.js" defer="defer"></script>
<script src="/assets/js/main.7b5a6ddd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/blog/tags">Tags</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/expanding-my-homelab-with-cloudflare-tailscale-and-more">Expanding my Home Lab with Cloudflare, Tailscale, and more</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tracking-chores-with-home-assistant">Tracking Chores with Home Assistant</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/what-settings-are-in-intune">What Group Policy Settings aren&#x27;t in Microsoft Intune?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/exploring-microsoft-intune-filters">Exploring Microsoft Intune Filters</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/making-dexcom-better-wtih-homeassistant">Making Dexcom better with Home Assistant Voice</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Getting Started with Microsoft Graph</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-07-13T00:00:00.000Z">July 13, 2025</time> · <!-- -->15 min read</div></header><div id="__blog-post-container" class="markdown"><p>A guide to show the different options for working with Microsoft Graph.</p>
<p>Good morning everyone! I&#x27;ve been struggling lately with things to write, and also struggling with making time to write. I feel like this summer we&#x27;ve been slammed at work with different projects, I&#x27;ve been slammed at home with different projects, and have generally just been a little tired. I&#x27;m attempting to launch a consulting company, so I&#x27;ve been working through trying to get that off the ground (design a website first), so that has been eating into my time. While weed eating our wooded trail yesterday, I was thinking of different posts to make. One that I&#x27;ve been wanting to write about is my thoughts on Microsoft Graph and all the pain points I&#x27;ve experienced myself as a general noobie to Graph. I&#x27;ve been using Microsoft Graph the last three years in different capacities. This would be either through the SDK, native API calls, or using Invoke-MgGraphRequest.</p>
<p>Last week, we had an incident pop-up where our Apple VPP apps had their assignments removed when we put in the new VPP cert. So, I wrote a Powershell script that called the Graph API to retrieve the application assignments after we went through and re-assigned everything. Unfortunately, I did not have this data beforehand. But, for this post, I&#x27;m going to use the script I developed as an example for configuration. The main script can be found here <a href="https://github.com/Pacers31Colts18/Intune/blob/main/Export-IntuneApplicationAssignments.ps1" target="_blank" rel="noopener noreferrer" class="">Export-IntuneApplicationAssignments</a></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="common-terms-and-painpoints">Common Terms and Painpoints<a href="#common-terms-and-painpoints" class="hash-link" aria-label="Direct link to Common Terms and Painpoints" title="Direct link to Common Terms and Painpoints" translate="no">​</a></h2>
<p>Before starting, I want to list out some common terms and some common pain points I&#x27;ve ran into. A lot of this will be dependent on what your environment looks like and what you are doing with Microsoft Graph.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="common-terms">Common Terms<a href="#common-terms" class="hash-link" aria-label="Direct link to Common Terms" title="Direct link to Common Terms" translate="no">​</a></h3>
<p>To use the Microsoft Graph API, you need access. Typically, Microsoft Graph is not going to be wide open for you to just connect to and run commands against. Thinking to the Active Directory world, you would have permissions delegated to your privileged account (hopefully) and then you would perform actions. Instead, in the Azure world, you will grant permissions to an App Registration. Microsoft has provided all the permissions to configure, allowing you to get very granular and use the principal of least privilege.</p>
<p><a href="https://learn.microsoft.com/en-us/entra/identity-platform/permissions-consent-overview" target="_blank" rel="noopener noreferrer" class="">Permissions Consent Overview</a></p>
<ul>
<li class="">Types of Access<!-- -->
<ul>
<li class="">Delegated<!-- -->
<ul>
<li class="">Connecting to a resource on behalf of the signed in user.</li>
<li class="">Used for running scripts on demand with no automation tied to it.</li>
<li class="">I use this most commonly in my day to day work over Application permissions.</li>
</ul>
</li>
<li class="">Application<!-- -->
<ul>
<li class="">Connecting to a resource as itself.</li>
<li class="">User is not needed to authenticate</li>
<li class="">I use this with automation (Azure Runbooks, Github Actions, etc)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Going back to the Active Directory scenario. With Delegated, I&#x27;d equate that to me running a script with my privileged account whenever necessary. Where if I then wanted any sort of automation (Scheduled Task maybe?), I&#x27;d probably have a Service Account with the permissions needed to then run the task.</p>
<ul>
<li class="">Pagination<!-- -->
<ul>
<li class="">Because you&#x27;re now working in this huge environment, that has multiple customers, we need to be more efficient. On some of the data requests, Microsoft &quot;pages&quot; the data. Meaning, you will only get back chunks of results at a time. If wanting to return ALL the data (because who doesn&#x27;t), you then have to use pagination to keep going through the results.</li>
</ul>
</li>
</ul>
<p><a href="https://learn.microsoft.com/en-us/graph/paging?tabs=http" target="_blank" rel="noopener noreferrer" class="">Paging Microsoft Graph data in your app</a>
<a href="https://practical365.com/pagination-graph-sdk/" target="_blank" rel="noopener noreferrer" class="">Practical Graph: All About Pagination and Fetching Data</a>
<a href="https://medium.com/@mozzeph/how-to-handle-microsoft-graph-paging-in-powershell-354663d4b32a" target="_blank" rel="noopener noreferrer" class="">How To Handle Microsoft Graph Paging in PowerShell</a></p>
<ul>
<li class="">Beta vs. v1.0<!-- -->
<ul>
<li class="">While Beta is just that, Beta. I&#x27;ve yet to really see anything go from Beta to 1.0, where much of the functionality needed is in Beta. For that reason, I tend to default to Beta, and only fall back to v1.0 if I absolutely have to.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="getting-started---app-registration">Getting Started - App Registration<a href="#getting-started---app-registration" class="hash-link" aria-label="Direct link to Getting Started - App Registration" title="Direct link to Getting Started - App Registration" translate="no">​</a></h2>
<ol>
<li class="">Open Azure (portal.azure.com), and go to App Registrations</li>
<li class="">Click <em>New Registration</em></li>
<li class="">Fill in the details, making note of the Redirect URI<!-- -->
<ul>
<li class="">This will prompt the user for authentication using the Microsoft authentication.</li>
</ul>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Delegated App Registration" src="/assets/images/appregistration-delegated-f3a75874f20c7ba48098ec29489ab502.png" width="914" height="558" class="img_ev3q"></p>
<ol start="4">
<li class="">Once created, click on API Permissions.<!-- -->
<ul>
<li class="">By default, the application will have User.Read permissions</li>
</ul>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Delegated API Permissions" src="/assets/images/appregistration-delegated-apipermissions-001de611312a520f7e2f981fed1ecda7.png" width="1053" height="228" class="img_ev3q"></p>
<ol start="5">
<li class="">Click Add a Permission</li>
<li class="">Click Microsoft Graph</li>
<li class="">Choose Permissions</li>
</ol>
<ul>
<li class="">Application</li>
<li class="">Delegated (I&#x27;m choosing Delegated in this walk through)</li>
</ul>
<ol start="8">
<li class="">Scroll down to DeviceManagementApps, then choose <strong>DeviceManagementApps.Read.All</strong>
<ul>
<li class="">We&#x27;re trying to use the principle of least privilege here, so we&#x27;re only choosing Read permissions.</li>
</ul>
</li>
<li class="">Now that the permission is added, we still aren&#x27;t done. Somebody has to sign off on the permissions being added, that&#x27;s why the Status is &quot;Not granted&quot;</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Grant Admin Consent" src="/assets/images/appregistration-permission1-162f9a0b617a1b7842dc07fdace25b46.png" width="1031" height="192" class="img_ev3q"></p>
<ol>
<li class="">We&#x27;ll need someone with the proper permissions to Grant Admin Consent.<!-- -->
<ul>
<li class=""><a href="https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/grant-admin-consent?pivots=portal" target="_blank" rel="noopener noreferrer" class="">Grant tenant-wide admin consent to an application</a></li>
</ul>
</li>
<li class="">Thankfully, this is my Lab tenant, and I have Global Admin.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Easy Peasy" src="/assets/images/easypeasy-41a471393636026e3d1e9470460caa5c.gif" width="320" height="180" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Granted Consent" src="/assets/images/appregistration-permission2-678ef7afd55fcc90f1696dd7caf0d627.png" width="1032" height="208" class="img_ev3q"></p>
<ol start="3">
<li class="">One last step, go to Authentication, and add <a href="http://localhost" target="_blank" rel="noopener noreferrer" class="">http://localhost</a> into the Mobile and Desktop applications Redirect URIs section</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Authentication" src="/assets/images/authentication-7b04821596855a4c63e5d03a7d2c7370.png" width="955" height="318" class="img_ev3q"></p>
<p>We&#x27;ve now configured our Delegated App Registration that will allow us to connect, we can then restrict who can access the application.</p>
<ol>
<li class="">Back in the Azure portal, go to Enterprise Applications.</li>
<li class="">Find your newly created application and go to Users and Groups.</li>
<li class="">Add any user who should have permissions here.</li>
</ol>
<p>So with this configuration we have:</p>
<p>User (with permissions) ---------&gt; Connects to Application ---------&gt; Application has permissions ------------&gt; Application makes requests to Microsoft Graph</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="thats-fantastic-but-how-do-i-know-what-permissions-i-need">That&#x27;s fantastic, but how do I know what permissions I need?<a href="#thats-fantastic-but-how-do-i-know-what-permissions-i-need" class="hash-link" aria-label="Direct link to That&#x27;s fantastic, but how do I know what permissions I need?" title="Direct link to That&#x27;s fantastic, but how do I know what permissions I need?" translate="no">​</a></h4>
<p>Knowing what permissions you need can be challenging. Fortunately, there are many tools provided to do such a job. I&#x27;m not going to go into great detail about how to use each one of them, those can be other posts.</p>
<p><a href="https://developer.microsoft.com/en-us/graph/graph-explorer" target="_blank" rel="noopener noreferrer" class="">Graph Explorer</a>
<a href="https://graphxray.merill.net/" target="_blank" rel="noopener noreferrer" class="">Graph X-Ray</a>
<a href="https://desktop.postman.com/?desktopVersion=10.6.0" target="_blank" rel="noopener noreferrer" class="">PostMan</a>
<a href="https://learn.microsoft.com/en-us/graph/api/overview?view=graph-rest-beta" target="_blank" rel="noopener noreferrer" class="">Graph API Documentation</a></p>
<p>Above are either tools from Microsoft or third party tools to get started. Personally, I like to just look at the network calls being made in Microsoft Edge to find out what the calls are, and then I can typically find the right permissions based off that. The Graph API documentation is also a great starting place, you just have to know how to navigate and know what you are looking for.</p>
<p>So in this example scenario, we&#x27;re wanting to get application assignments.</p>
<ol>
<li class="">Go to <a href="https://intune.microsoft.com" target="_blank" rel="noopener noreferrer" class="">Microsoft Intune</a></li>
<li class="">Click Apps</li>
<li class="">Using Edge, hit F12 and open Developer Tools.</li>
<li class="">Make sure the Network tab is selected.</li>
<li class="">In this case (probably a bad example to be honest) I&#x27;m going to create a new app with the Network tab open</li>
<li class="">Make the application available to All Users</li>
</ol>
<p>You should then start seeing a bunch of calls being made</p>
<p><img decoding="async" loading="lazy" alt="Developer Tools" src="/assets/images/developertools-name-e4527c2f1d4d69499d0d90e7c89eed44.png" width="196" height="1089" class="img_ev3q"></p>
<p>Most of this looks like garbage to me, anything with .js is worthless to me.</p>
<p><img decoding="async" loading="lazy" alt="Developer Tools - Request URL" src="/assets/images/developertools-requesturl-9df0831549d4f1cb665c755e11fd1c4f.png" width="338" height="245" class="img_ev3q"></p>
<p>But, I then see this mobileapps. This is my starting point for configuring the permissions (and when I go to write my PowerShell script)</p>
<p><a href="https://graph.microsoft.com/beta/**deviceAppManagement**/mobileApps/" target="_blank" rel="noopener noreferrer" class="">https://graph.microsoft.com/beta/**deviceAppManagement**/mobileApps/</a></p>
<ul>
<li class="">DeviceAppManagement (Intune) = DeviceManagementApps (Azure)<!-- -->
<ul>
<li class="">Microsoft is never consistent with naming!</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="authentication">Authentication<a href="#authentication" class="hash-link" aria-label="Direct link to Authentication" title="Direct link to Authentication" translate="no">​</a></h2>
<p>Okay, now we have the App Registration configured, how do we connect to it?</p>
<p>We have two scenarios for connection, native Rest API connection(Get-MSALToken), or connecting with Microsoft Graph.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="invoke-restmethodget-msaltoken">Invoke-RestMethod/Get-MSALToken<a href="#invoke-restmethodget-msaltoken" class="hash-link" aria-label="Direct link to Invoke-RestMethod/Get-MSALToken" title="Direct link to Invoke-RestMethod/Get-MSALToken" translate="no">​</a></h3>
<p>I find this to be the most difficult to connect to, but let&#x27;s give it a shot and see if I can explain it and figure it out myself.</p>
<ol>
<li class="">Install Get-MSALToken</li>
</ol>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Install-Module -Name MSAL.PS -Scope CurrentUser</span><br></span></code></pre></div></div>
<p>Now that we have the module installed, we need to configure our parameters.</p>
<p>On the Overview page of your App Registration, you&#x27;ll find the details needed. You can use either your domain name or actual tenant ID for the below portion. I&#x27;m using my tenant domain name.</p>
<p><img decoding="async" loading="lazy" alt="Overview" src="/assets/images/overview-dacbbc750e620e890c8e71732216e1da.png" width="839" height="292" class="img_ev3q"></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$token = Get-MsalToken -clientid &quot;CLIENTIDHERE&quot; -tenantid &quot;joeloveless.com&quot; -Interactive</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$header = @{&#x27;Authorization&#x27; = $token.createauthorizationHeader();&#x27;ConsistencyLevel&#x27; = &#x27;eventual&#x27;}</span><br></span></code></pre></div></div>
<p>In this example (Delegated), I am looking to connect interactively. If I wanted this in an automated scenario, I&#x27;d be looking at using Client Secrets, Federation, or Certificates to pass the authentication.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="connect-mggraph">Connect-MgGraph<a href="#connect-mggraph" class="hash-link" aria-label="Direct link to Connect-MgGraph" title="Direct link to Connect-MgGraph" translate="no">​</a></h3>
<p>The next option (and simpler IMO) is to connect using <strong>Connect-MGGraph</strong></p>
<p><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.graph.authentication/connect-mggraph?view=graph-powershell-1.0" target="_blank" rel="noopener noreferrer" class="">Connect-MgGraph</a></p>
<p>We&#x27;ll need the Microsoft.Graph.Authentication module.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Install-Module -Name Microsoft.graph.authentication -Scope CurrentUser</span><br></span></code></pre></div></div>
<p>From here, we just need to run a one liner to then connect:</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">connect-MgGraph -ClientId &quot;ClientIDHere&quot; -TenantId &quot;joeloveless.com&quot;</span><br></span></code></pre></div></div>
<p>Neither are overly difficult to configure, but Connect-MgGraph is just a tad simpler. Personally, I go with Connect-MgGraph, based off this paragraph from the PowerShell Gallery</p>
<p><em>The MSAL.PS PowerShell module wraps MSAL.NET functionality into PowerShell-friendly cmdlets and is not supported by Microsoft. Microsoft support does not extend beyond the underlying MSAL.NET library. For any inquiries regarding the PowerShell module itself, you may contact the author on GitHub or PowerShell Gallery.</em></p>
<p>Microsoft doesn&#x27;t officially support MSAL, where they do officially support the Graph SDK.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="option-1-scripting-natively-with-invoke-restmethod">Option 1: Scripting natively with Invoke-RestMethod<a href="#option-1-scripting-natively-with-invoke-restmethod" class="hash-link" aria-label="Direct link to Option 1: Scripting natively with Invoke-RestMethod" title="Direct link to Option 1: Scripting natively with Invoke-RestMethod" translate="no">​</a></h2>
<p><a href="https://github.com/Pacers31Colts18/Intune/blob/main/Export-IntuneApplicationAssignments-Invoke-RestMethod.ps1" target="_blank" rel="noopener noreferrer" class="">Full Script Here</a></p>
<p>In this scenario, we&#x27;ve already connected using the Invoke-RestMethod/Get-MSALToken method from above, connecting to our delegated application and are ready to start writing PowerShell scripts.</p>
<p>I&#x27;ve added the full script <a href="https://github.com/Pacers31Colts18/Intune/blob/main/Export-IntuneApplicationAssignments%20-%20Invoke-RestMethod" target="_blank" rel="noopener noreferrer" class="">here</a>, but I want to highlight the key differences in each script. The guts of the script are the same, just a little different for each one.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Check Graph connection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($null -eq ($header)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Write-Error &quot;Authentication needed. Please call connect to Microsoft Graph.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre></div></div>
<p>Here we are checking for the $header not to be null, as that is the variable we&#x27;re using from above to store the authorization.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#region Get application details</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $uri = &quot;https://graph.microsoft.com/$graphApiVersion/deviceAppManagement/mobileApps?`$expand=assignments&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $resultCheck = @()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    do {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $response = Invoke-RestMethod -Uri $Uri -Method Get -Headers $Header</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $resultCheck += $response.value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $uri = $response.&#x27;@odata.nextLink&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } while ($uri)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span></code></pre></div></div>
<p>The key difference here is the $response variable. We need an extra parameter, Headers to achieve the desired results. The above code is what I use for the <strong>pagination</strong> scenario from the Common Terms section. I&#x27;m looking for repeatable code, and this is what I have found to work perfectly, without over complicating things.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;#microsoft.graph.groupAssignmentTarget&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            $uri = &quot;https://graph.microsoft.com/$graphApiVersion/groups/$($assignment.target.groupid)&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            $group = Invoke-RestMethod -Uri $Uri -Method Get -Headers $Header</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        catch {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            Write-Error &quot;Unable to get group details: $_&quot;</span><br></span></code></pre></div></div>
<p>Similar to above</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#region Filter Details</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                $filterId = $assignment.target.deviceAndAppManagementAssignmentFilterId</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                $filterType = $assignment.target.deviceAndAppManagementAssignmentFilterType</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if ($filterId -and $filterId.Length -eq 36) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        $uri = &quot;https://graph.microsoft.com/$graphApiVersion/devicemanagement/assignmentFilters/$filterId&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        $filterResponse = Invoke-RestMethod -Uri $Uri -Method Get -Headers $Header</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        $filterName = $filterResponse.displayName</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    catch {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        Write-Warning &quot;Failed to get filter details for ID $filterId&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                #endregion</span><br></span></code></pre></div></div>
<p>Again, pointing out the difference with the Headers variable.</p>
<p>#Option 2: Using MgGraph</p>
<p><a href="https://github.com/Pacers31Colts18/Intune/blob/main/Export-IntuneApplicationAssignments%20-%20MgGraph.ps1" target="_blank" rel="noopener noreferrer" class="">Full Script Here</a></p>
<p>In this scenario, we&#x27;ve connected to Graph using <strong>Connect-MgGraph</strong>, using my preferred way of connecting.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Check Graph connection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($null -eq (Get-MgContext)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Write-Error &quot;Authentication needed. Please call connect to Microsoft Graph.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre></div></div>
<p>This is using Get-MgContext to do the connection check, running this will give you more information on how you are connected, what scopes you have, etc.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#region Get application details</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $uri = &quot;https://graph.microsoft.com/$graphApiVersion/deviceAppManagement/mobileApps?`$expand=assignments&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $resultCheck = @()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    do {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $response = Invoke-MgGraphRequest -Method GET -Uri $uri</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $resultCheck += $response.value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $uri = $response.&#x27;@odata.nextLink&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } while ($uri)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span></code></pre></div></div>
<p>One less parameter to worry about</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;#microsoft.graph.groupAssignmentTarget&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            $uri = &quot;https://graph.microsoft.com/$graphApiVersion/groups/$($assignment.target.groupid)&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            $group = Invoke-MgGraphRequest -Uri $uri -Method GET</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        catch {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            Write-Error &quot;Unable to get group details: $_&quot;</span><br></span></code></pre></div></div>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">if ($filterId -and $filterId.Length -eq 36) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        $uri = &quot;https://graph.microsoft.com/$graphApiVersion/devicemanagement/assignmentFilters/$filterId&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        $filterResponse = Invoke-MgGraphRequest -Uri $uri -Method GET</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        $filterName = $filterResponse.displayName</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    catch {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        Write-Warning &quot;Failed to get filter details for ID $filterId&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="option-3-using-graph-powershell-cmdlets">Option 3: Using Graph PowerShell Cmdlets<a href="#option-3-using-graph-powershell-cmdlets" class="hash-link" aria-label="Direct link to Option 3: Using Graph PowerShell Cmdlets" title="Direct link to Option 3: Using Graph PowerShell Cmdlets" translate="no">​</a></h2>
<p><a href="https://github.com/Pacers31Colts18/Intune/blob/main/Export-IntuneApplicationAssignments-GraphSDK.ps1" target="_blank" rel="noopener noreferrer" class="">Full Script Here</a></p>
<p>We had two options to connect to Graph, but now we have three options to run commands against Graph? What the hell?</p>
<p><img decoding="async" loading="lazy" alt="Huh?" src="/assets/images/wedding-crashers-2044d882061b5564cf65484efab3d697.gif" width="460" height="199" class="img_ev3q"></p>
<p>Microsoft attempted to make this easier for us. In doing so, what they really did was create confusion. Many of the cmdlets are half baked, have really poor documentation, sometimes work, most of the time don&#x27;t work, and are just down right confusing. I&#x27;ve struggled finding the right commands to use, and when I do find the right commands to use, nothing really seems to work just the way I expect it to. With the first two options, the code is very repeatable, where with this option, it takes a minute to find the right commands, then you have to hop on one foot and hope they work correctly.</p>
<p><a href="https://learn.microsoft.com/en-us/powershell/microsoftgraph/get-started?view=graph-powershell-1.0" target="_blank" rel="noopener noreferrer" class="">Get started with the Microsoft Graph PowerShell SDK</a></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="find-mggraphcommand">Find-MgGraphCommand<a href="#find-mggraphcommand" class="hash-link" aria-label="Direct link to Find-MgGraphCommand" title="Direct link to Find-MgGraphCommand" translate="no">​</a></h3>
<p>Where with the first two options, I could go to the API documentation and just find the URLs, I have to do a little bit more digging to find the right commands needed.</p>
<ol>
<li class="">Navigate to the Graph API documentation, in this case, we&#x27;re looking for <a href="https://learn.microsoft.com/en-us/graph/api/resources/intune-app-conceptual?view=graph-rest-beta" target="_blank" rel="noopener noreferrer" class="">Corporate Management &gt; App Management</a>, which in turn points us to the URL of</li>
</ol>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/deviceAppManagement/mobileApps</span><br></span></code></pre></div></div>
<ol start="2">
<li class="">Now that we have the URL, we can run Find-MgGraphCommand</li>
</ol>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Find-MgGraphCommand -Uri &#x27;/deviceAppManagement/mobileapps&#x27;</span><br></span></code></pre></div></div>
<p>This will then return us the available cmdlets to use.</p>
<p><img decoding="async" loading="lazy" alt="Find-MgGraphCommand Results" src="/assets/images/find-mggraph-dfe4edf98745bc9c780733016d0c007b.png" width="2062" height="204" class="img_ev3q"></p>
<ol start="3">
<li class="">Going down even further, we can run the following:</li>
</ol>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Find-MgGraphCommand -Command Get-MgbetaDeviceAppManagementMobileApp</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Find-MgGraphCommand -Command" src="/assets/images/find-mggraph2-fd5f0106f1a7cd378e023d6844486a1d.png" width="2070" height="137" class="img_ev3q"></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="building-the-script">Building the script<a href="#building-the-script" class="hash-link" aria-label="Direct link to Building the script" title="Direct link to Building the script" translate="no">​</a></h4>
<p>First thing I noticed, I have another module to install.</p>
<p>So to build this script, I&#x27;ll need the following:</p>
<ul>
<li class="">Microsoft.Graph.Authentication</li>
<li class="">Microsoft.Graph.Beta.Devices.CorporateManagement</li>
</ul>
<p>This is just for this example script. If I had a script that was peicing together multiple parts of Intune, I&#x27;d have a whole lot of dependencies and hoping there aren&#x27;t issues at any point. Where with the previous two, I&#x27;m relying on exactly one module to install.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#region Get application details</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $resultCheck = @()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    do {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $response = Get-MgBetaDeviceAppManagementMobileApp -All -ExpandProperty Assignments </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $resultCheck += $response</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        $uri = $response.&#x27;@odata.nextLink&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } while ($uri)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #endregion</span><br></span></code></pre></div></div>
<p>This is a little bit less code, but did I really save any time by having to research this and peice it all together?</p>
<p>Now I&#x27;m down to the Groups portion of the script.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;#microsoft.graph.groupAssignmentTarget&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            $uri = &quot;https://graph.microsoft.com/$graphApiVersion/groups/$($assignment.target.groupid)&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            $group = Invoke-MgGraphRequest -Uri $uri -Method GET</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        catch {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            Write-Error &quot;Unable to get group details: $_&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        }</span><br></span></code></pre></div></div>
<p>Previously I had this in Option 2. Now I need to find the commands again.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Find-MgGraphCommand -Uri &#x27;/groups&#x27;</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Find-MgGraph Groups" src="/assets/images/findmggraph-groups-21a6abb49e9d8a6eef3f58af25cead4d.png" width="1264" height="204" class="img_ev3q"></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Find-MgGraphCommand -Command get-mggroup</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Find-MgGraph Groups Command" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABNwAAABhCAIAAACCtSv/AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAASdEVYdFNvZnR3YXJlAEdyZWVuc2hvdF5VCAUAAB5LSURBVHhe7Z3Pi13HlcebYYZkBrQwZJMMwWQcGO+GgXgRZiYL74SSzEAWJg6jWVrYcYghZsBE2P4XhB3ZcRJ5F2UT5DgidBaBOCBHyJYEycIL2RPFAhksLWT/A0O/o64unfOtuvXeu7fuU78PfDBWvao6p86Pqjr3vu7e+Zu//XsAAAAAAACAWdiJTQAAAAAAAAB9oCgFAAAAAACA2aAoBQAAAAAAgNmgKAUAAAAAAIDZoCgFAAAAAACA2aAoBQAAAAAAgNmgKAUAAAAAAIDZoCgFAAAAAACA2aAoBQAAAAAAgNmgKAUAAAAAAIDZoCgFAAAAAACA2aAoBQAAAAAAgNmgKAUAAAAAAIDZoCgFAAAAAACA2aAoBQAAAAAAgNmgKAUAAAAAAIDZ2JSi9JnLTz331qOxfdOo6/nE7598/spTC74VP52aZy4/9f1ffCW216mvCAA2mTXzd83hAAAAneHkOqzsHHvp2/t11FNHn/1C7NGHzhH21WePPn/lrsR/OvqV/73cWka26LkoTZtmy1lWpShl9KLUVEpRsQiV4/u63SWNfSZrfP7KKppAC8nOJa8lYoQshRuebxT7HP+Xow/EgRDJs2PQcUuxmHl1L685HAAAoBF3r7D75PGXH44966xzcq15NYJJ2cmrjm+89G+xRx8qpdEUWLllcbl/226K0RY9V4v4ZVWKUnoWpSbIOuRCK7PB+uQuHjR1jJClKA0flAuR5DhLHwwIAADbhl1u771V9n4fVrrbwCawI8uY7Ln+nuceO3vi+7/4z0Xj8f966evWLhvlcGs5/vK/77cfvGCZ7gVCna8+e/S5tx59/OyJo89+4bGzJ/7n7Dcryks9K+VBjPj0td7KGisqueHxnZVpslDpa/udpZFrK4oMFqXODtEUMCJm/+TW9M8YipUIiWnYPjzvY///2NkTuUoWMMdfflgKipG8PeRGzo0WDfLE75987q1Hv7z/fYTjLz9c2mnT2Phwar9dbgJedHl4++7NO3MAABggXRLsn/ltOR498TRc8+Sq3G04zjaEnfjePL902v/v36L+MQ8R2bgoqL5pY/Pqxfxt5U26n0VBUb+JOPbSt59769FvvPTtRch+6z/28uTu/T6qVGpsLEpd1smnABWVSsNj6dtuZNkYGSxK3f5Snw3WZJFxBx5P3imFYj1CLG0rkRyHxz4uAJKGUlApkreBUJTu2UEaZGGu/34ms1hpp7WBcbeJCSgb5XC5M8iNpTInAACAxJ0ydqDIwiGehmkS9085XJ5ccSzH2Ubhi1JZhzx29kS6Vh5/+WHzumx0b+ErJZwT1LmYsQrQrnff/8VXFsocl2sv6RlXlCbPI959Y97VFYMqVYbHvIoqLbWiiBx+78+U+kdKldlgTWRRaq8lZSjWIyS9r2sfHvvku3keq1FQJZK3gWSQdGSWDLIw+920qmy/laI0z9lKYxwu870UIZU5AQAAJOnu4U6cxL2nzD2n4b3futJXiMFbehzLcbY5+KLUfcO7ciuSjUef/YLFWaIUHE5Q52LGKsB/+LsvP7PQeaH8cbn2kp5xRWnyeM+7F51IUqXK8JhXUaWlVhSRl1T3IMqNjS0wFrIoXfZNaepZLznk8Ngnnyc/M6KgSiRvA9lXg+5apmSQaPbSTmufuv7ymZFsjMPldlGKkMqcAAAAkvQ8Pb/SyMIhnoYJ95EcLk+uOJbjbKPwP1Pq7iX2SEPeimRjXrHkcRCDo700moKkvCGLUlt7Sc+4ojRbHvHufUgFqVJleMyrqNJSK4q4ojR/5WWC3FT12WBN8qpvsGYYjJB0HrQPj31Sy/GX//WJ3z+Zz+MEVSJ5G8gNYpQMEs0ud9pSUZqw3JTbe95YKUoH36WX5gQAACixOFP2fgGKHRylwqF0uslrdhxeOrkq03Kczc49v3338bNfc84zp8pbkWzMb1rm3VJw5GG0uP34u86kqArw7ksnt/aSnqlnVN5FfCUBckoqlYanK2NqiUaW3iytSJLPaV/UzIe7vcCJg3GJO6/9fykUKxGST9U+PE3iXGwD3ZOOKKgUydtALEpLBomNcqcdLEpjbspGNzxuF6WNpTInAABACXdnKBUOpdNNFqVxeOnkKt1tOM42gZ0UHPK7XuYbeSuSjfabY9PY1EcGh0WP69mHxS+0PAi7pHxce0nP9G0Bt8z8KwQpZ+KX9yIllSrDU3vl7ti+Ikk+PJ8wTbXYGu6+TsnXXlomrIP0pgxFI0ZIdFD78NToAsZmkAPjWNl+6JFFqTRIPIZLO63LuLgFJY8MNrrsdg6SG4ucEwAAoM7+FfSgMpSFQzwNSyeXHC5PLjdJvBpxnM3LTmwCgENJqTRak/wBijGRIAAAAAA4lFCUAmwLE9WK8depTyQIAAAAAA4lFKUA28LoteL+d2bEF2zGFQQAAAAAhxiKUgAAAAAAAJgNilIAAAAAAACYDYpSAAAAAAAAmA2KUgAAAAAAAJgNilIAAAAAAACYDYpSAAAAAAAAmA2KUgAAAAAAAJgNilIAAAAAAACYDYpSAAAAAAAAmA2KUgAAAAAAAJiNneevPLXPt6zpq88enbGxG1J6t0aJ7NmtUSJ7tjfCuEgj39eNW4Jc++FrBAAAqCDPjg1shFngTSkAAAAAAADMBkUpAAAAAAAAzAZFKQAAAAAAAMwGRSkAAAAAAADMBkUpAAAAAAAAzAZFKQAAAAAAAMwGRSkAAAAAAADMBkUpAAAAAAAAzAZFKQAAAAAAAMwGRSkAAAAAAADMBkUptHLmwp0rb/4gts+IU+mRE+ev3fr05u0brz/9xdi5P0eOnH73409ufPDbxz93JH6alD957vpHtz8tdVuZuvQOHDt16aPbn350u6tHPvPZ7+5e+2T39D/Hj2Zn0+KzhU22p7HCvmQZ99HtT//v4s/qjVvICvbstttIH8nGLWQFx0nTycb16RMhG84KPupmOul32ShZ9hpzP56GFcby0WoRIllHpWW9OSI7KeYGg6PFWBZnqduZC3du3rr6woMPxJ5Gu/QpmFe6JKp05sIdazGuvPmDdNdP1I08CgvPXplaylI4lez2PBiiPalvCi6hBvPLFuiCoZJxdelTY9JdMSPXGGN+HSpF1LiClkXGZweVKhHSQsWeK+MiefC6U0cGVY5ZICbCyXPXo2jZ2EgHb0qmsGe06pkLdyphIHebOMlS4LilGLR2B3u6y0muj4yQNRlc8vpM4aOo9qFJrkat1jwNG6WUWE2Q1Dl1kD5yyCtcRWI7cpRUSfYssVTnsdhJF5TPfPa7b769WzFoi37HTl268cGNP/1xL3yPHDl98f0PK5VMfj0alD4680qXSJVKZpcZMh0nz13vJqsRp9IiAwe2mI3CefbYqUst+77z+1IZ1xP5FCMGs4z5OFs7pSJqdEHLEuOzj0prRkjJnuuQz2kH5zp7Swwqx95G8euf7l770G0O8qYlG1vo403JFPY8c+GOs0P93iwZdE0dHLcUg9buYM9jpy4lY7rHYVMwuOT1mcJHhzi5Gq8xa56G66x9HUEnz13Pa7y4ihbqV/fVltY+qr1nuzfHZScaNK/mTaH0XGHwcdFiDbu71y6/8OADx05d2j39mvnMkjkNv3n7xmLDEu40kyWJ+V5gLRYT7qpkObNo/PD17/3YOldeCPSUnttzZZVi/3pkj4vLvejN15/+YmfTxe2g0NJDT0kSkSdLviL3nKwx/53fSxknpbsn2TZJo0FK7pA93e2ktIfUY96plEvPfOTdse+41/LGpQTFFa0fDDE+u6lUipDcnhYk+z0/uXn7xs9/9Bt7ji7tKY+JkvKRXPk8nuWc0e/1PCrJio/V5E1LNg7SzZtR9ET2dHZIIuSK4m4j872kkgTHrea4KMXJmtSebttP/4wRUjKyXHs8uUoBFn0kBZX0jCuawkeHOLkarzGNp2FcUWntjawpyA1fPPDd83L0USkYXBTFnimLo0qLFr+xSD3bw6aeCI3eHJed+JAgPcVxtitVRzm2hpPnri8S7N0XH3rFIi/NaQ/PLBlyP+XSc7OmW1Hup/19Xx4GezcqC5r4OCrRU3pjPldUkmaPkT0dbgnRm/1NFz+KRWk3PSuUTBc925j/zu+ljLNPnfS9HSd8X6XRIHE2p0zqKfe+JCtfciXmnUqPf+7ID8+9Y5onodIdeWPq2S5IrmiUYHDx2U2lUoTEfd6ufXY3unnrqvWUc+b/k6sXlY8LTENMeZebcc7o93oeORbz770ZTheI9FGM51LjIKXFRoOs6c0oeiJ7JjvYO5xF572XKnFFadXRdNE1UiUJjlvNcVGK0cee7lLrLvHxNIyxJNcuT664ZOkjKchq1+S4zj46xMnVeI1pPw3liuLaG1lTUP1TZyUZDPGfMkKkSvY/7m4jNSmpFHvWE6HRm+OyV5Raplk1f+TI6Xc+PvhyVx6ypWXnmAkeOXH+zxcv/+Htn1nk5ctOpkzBkUu3LSlJtMxR29yVfKdwh0FqjPmW69lN+slz10sP4RpVyu/3af4Y2RPh1iW9aeHRzXSufz5/6txTT6deTr4pOA1dQrlPSzi/y4yTl4BSwDQaxJ7JOXeUesaPkiy3iZdi3qnk5qm4QzquXZBckZxTSq8Eg1tIN5VkhMh9Pi3B3GQ945w3b12Vw6XyMp5tTtvQ0l2zNGc+MK2lkkeOlALxoVU8sEuNg3TzpgywKexp/b/z+Vfe/ThVX3fvzSUXR9PFC9CgSk43HCeHVxwXpeRDprans1LlPJJHj1x76eSKS5Y+euHBB6IgO85KBsmZwkeHOLkq236lm0zDyorqoV5hfUFphkbTxY9cPMsIkSrJ3SYfVZdb6lkJhkZvjsvBm1JbdnJVouKevLPtBba8ZDtLNvunLXsxZG/Z7olFfq1xUlx2LXUYxGtx6t9TeiosZdwsq5JR2anHxVlAelOGx3SmczNb/Zm3dNYzJkKaPN8U5O6Ta2LzlPY1w/ldZpy8BORVek5UQxpEuqPSU2afk7VUzLutqeQO6bh2QXJFck4pXe42Mj67qSQjxBnT9nmngyxKTbocLpWX3KvM3WAuzRn9PphHUZDsGQ/sUuMg3bwpA2wKe5qeTzx5/ndv/mT32uUXH3rFLklxRYloOte5pFKcCsdFKzU6LkrpaU9VFtaKUqewXHvp5IozSB+VgjZ9Wn8dNIWPDndymSal/u2nYWVFFUPVWV9QCmkXbNFKMRisPQ+kPA7tnyZRqiR3m3xUrmfsU+pZT4S6N6fg4GdKM/foyjguJuK+oZ6MmL/usw57m1f2fYz6YZBvc5WrZzwMSmk5i3TLxpIN21UyXGRPR1QgelN2m850UVbM7Vn0jOSbgtx9cjUGZ4t+L2Vc+tRthfFobzRIbtjkjkrPOCrKao95FwAVd0gLtAuSK5JzSukV9znvd1NJRkhMlqiDLErrx0RUXpLPmVYn55R+r+dRjjzak4/igV1qHKSbN2WATWHPR06cf+/93776xt430Bbf/X5tpHuzV0mC41Z2XJTS256ZldyXa9ycUWG59tLJFWeQPioFbZq2/kuGpvDRIU6uSrTnOG1lGlZWVDFUnfUFWTzIX6GcW0kGg5vB/lmKkKiS3G1KesY+pZ6VRGj05rjsJJH5lU7Gn3vGIGm/ANlHTro8DHLvJnfmfrUfhXKHQb0CnEW6i8WVVWqZbSyi72KLEfWcyHQlBewOnbabUrdJ9YzEfcqG2w9e5sPlY6qI87vMOLltxSuC0WgQqUOlp7sfJAXyPaQ95nPT2Zlacoe0wLKCpggGF5/dVJIRYv918eZ0MIXzOZ30GK5RecNclhbbPqf0eyWPnCB3pi4+Lb63KTW6OSXdvClVmsKeZqv3PtjbQo+duvSXi5dXuDfLfI82jyvCcSs7TgrqZs98208/o16aMxpZrr10csUAkz6SgoyFWW689/49K+rgo/s6ucwXL37paRPnhjdeY+xwqZ+GlRXJYqQlPkcRtGi8EX9hUumyl4Ih1yE5WkaIVCkPxeiUqKf0puwpE6Hdm+Oyk79NMl1t5fEVU95eUtQlVTKi+8HI1CdKl2lpbnOizdM28NU3/poOgyilRAfprrFkt7pKqSW6I2o7LjGmnZJJpW6mkyrFba6bnhLXM02bfoWgfac0n2Ew/+Oc8XGd9Yk9c+utZpCSO2JPQxalcg+RMR9VSprfvHX1l78quiPtOWnUsoLkitYJhmxaf4x1UElGSPo2Wt65UpTGZcp2qXy8LjgfpafXcs7o90oeOUFy7TI7ZGM+KgZzpIM3886T2jO/SJnCpRUNmi5vlCrFFeG4OEOj46SgbvbMf0dueiVVmlMaWa5dnlwywKSPpKDU2X3UwUf3dXJNUZQaMQ1LK4prb4zPUQTJCHFWksEQe5qgGCFx2tIDd6lnFFTqaY0yEdq9OS47sWl0Fi48eGflgnhEnM86M6/0KZAbxxTebDedVEl+NK+eKzBL/t/XTOqOQZaVXgndsVhWJWgk/wUk3cCb64PjxmUWe05Hhz1522i8xkxk+UMWn90ouaPRm+PSoyit/5jBiMx7GMwrvRtTeHMU07lJNlbPEvEpKdSZ1B2DLCt92f4r0EHEtmHPsGe56ODNdcBx4zKjPaej8pdgYDUarzGj58ihjM9ulBKh0Zvj0qModa/L168NSowe6Esxr/SejO7NsUxnX6tI3xraWD0d9jWPUTTcKiZyRyMrSHfxOTorqAQbC968T8Fxm4/dDahhRmTZa8zUpyG0UEqEZb05Ip2KUgAAAAAAAIAIRSkAAAAAAADMBkUpAAAAAAAAzAZFKQAAAAAAAMwGRSm0Mstv4oKVyf8AWvy0A+mvb/X8ZQab/FtG7sdf7bDJ9jRW2JfSX5DLf+WgbNxCVrBnt91G+kg2biErOE6aTjauT58I2XBW8FE300m/y0aJ9WxXsvE0XGfty6oEm8DOwR94HQqOlnSyOEvdzly4U//1Te3Sp2Be6ZKoUv4rZO1P6OZ/n/pu56qRR8H92U/oj5UHLhgqGbfObr4+Jt0VM3IPiTG/DpUialxBy2KKueV3UKkSIS1U7LkyLpIHrzt1ZFDluL91nsj/+Hi9sZEO3pRMYc9o1TMX7lTCQO42cZKlwHFLMWjtDvZ0l5NcHxkhazK45PWZwkdR7UOTXI1axdPw2KlLUZnS2iUl0aV22Ex20gXlM5/97ptv71Yc3+LaRWDd+NMf98L3yJHTF9//sFLJ5NejQemjM690iVSpZPaY1ZNy8tz1brKggvP7UhnXE/kUIwazjPk4WzulImp0QcsS/z51H5XWjJCSPdchn9PuHOvsLTGoHHt7169/unvtQ1dvyJuWbGyhjzclU9gz/uW6+r1ZMuiaOjhuKQat3cGe+Z8Hd4/DpmBwyeszhY8OcXIdO3WppWc8DUtFaTslgzSqBBvCTnwumD8ZMl+m54iDj4sW7t/dvXb5hQcfOHbq0u7p1yzyLJnT8Ju3byw2LPFU0gIrScz3AmuxwHVXJcuZReOHr3/vx9a58kKgp/TcniurFPv3LErdDhK9+frTX5zRdFuF83sp40rfusmfZNskjY4ruUP2dLeT0h5Sj3mnUi49iyUfNvsB9lreuJSguKKlgraES6JuKpUiJLenBcl+z09u3r7x8x/9xp6jS3vKY6KkfCRXPo9nOWf0u2t0L2RKsuJjNXnTko2DdPNmFD2RPZ0dkgi5orjbyHwvqSTBcas5Lkpxsia1p9v20z9jhJSMLNceT65SgEUfSUElPeOKpvDRIU6uxgqwsSiNa3fLdNHlDJJmblEJNoSd+GQiPcXJM7BSHeWY+0+eu75IsHdffOgVi7w0pz08s2SIIWhSUkhZn7gR7O/78jDYu1FZrMfHUYme0hvzuaKSNLvzzqS4JURvzmu6rcL5vZRx9qkz4N7RG76f1ui4OJs8pE2Z0gnhgrkS806lxz935Ifn3jHNk1AZNnlj6tkuSK5oqaAt4Y7hbiqVIiTu83bts7vRzVtXraecM/+fXL2ofFxgfiWKe0icM/rdWbu0QxrpjX289MR4LjUOUlpsNMia3oyiJ7JnsoO9w1l03nupEleUVh1NF10jVZLguNUcF6UYfezpqjtX87s5o5Htq2Fx7fLkikuWPpKCrHZNjuvso0OcXI0VYGNRajjpJWWiQYxGlWBD2CtKLdPs0c6RI6ff+fjgy115oJRcnmPh8siJ83++ePkPb//MIi/P/5QtKeVy6bYlJYmWOWqbu1I5DFJjPcq7ST957nrpIVyjSvn9Ps0/uO+MhVuX9KaFx1ym2yqc32XGyUtAKWAaHWfPI507Sj3jR0lWrkAl5p1Kbp5K2MgAaxckVyTnlNLlbpNPlWbuppKMELnPpyWYm6xnnPPmratyuFReJq/NefdR9/5dszRnPjCtJZ+5fjClFIjXIHm5kY2DdPOmDLAp7Gn9v/P5V979OFVfd+/NJRdH0znXtKjkdMNxcnjFcVFKPmRqezorVc4jefTItZdOrrhk6aMXHnwgCrLjrGSQnCl8dIiTq7Lt17tVFHbS4z3EKMV/lAWbzMGbUouJtDUnUqBEl+edLUrcpmzJZv+0qFoM2csB9xzI3YdyKS5YlzoMZOzmR1Ef6amwlDmzrEpGZaceF2cB6U0ZHt1Mt1U4v8uMk5cA92w40eg46Y5KT5l9paLUyY0qud3GHifLsJEB1i5IrkjOKaXL3cYsn0+71NrXVElGiNznnQ6yKDXpcrhUXnKvMneDuTRn9HseZjGopCDZU960ZOMg3bwpA2wKe5qeTzx5/ndv/mT32uUXH3rFrrxxRYloOte5pFKcCsdFKzU6LkrpaU9VFtaKUqewXHvp5IozSB+VgjZ9Wn+TNoWPDndymSal/vI0jL7LidLltbBivbpKsFEc/EypxYRLoZyKyxPuG+op+vPXfdZhb/PKvo9RPwzyba5y9YyHQSnKZ5Fu2ViyYbtKRr5FTkpUIHpTdutmuq3C+b2UcenTtBG7jxKNjsv3hOSOSs84Kspqj3kXAJWwkRZoFyRXJOeU0uVuY7ittZtKMkLkPu90kEVp/ZiIykvyOdPq5JzS7/KeF6UMXtTiXafUOEg3b8oAm8Kej5w4/977v331jb2vIy6++/3aSPdmr5IEx63suCiltz0zK7mXWm7OqLBce+nkijNIH5WCNk1b/yVDU/joECdXJdpzoraVgSXpzuAl61Vmhg1kJ3krv9LJCHDPFCXtFyD7yEmXh0EeeTYq/TiZNdqPQrnDoF7GzCI9HxVpV6lltrGIvostRtSzm+m2CmcKmXHukpQ+ld97aXSc1KHS090PkgL5HtIe8ybI1mVnailspAWWFTRK0DoWfQ6uv91UkhFi/3X7/GBR6qTHYyIqb5jL0mLb55R+zxvtB5iTUCfIXUcWnxbf25Qa3ZySbt6UKk1hT7PVex/sbfXHTl36y8XLK9ybZb5Hm8cV4biVHScFdbNnvu2nn1EvzRmNLNdeOrligEkfSUHGwiw33nv/nhV18NF9nVzmixe/9LSJc8Prr50TdrikUVGrHKmSc3E0SD6zHA6byU7+1ss8ap6Or8Ly9pKPXVKlfHY/GJn6ROkyLS2xnWjLNBv46ht/TYdBlFKig3TXWLJbXaXUEt0RtR0XuR1IlWY33aHHGcQMJTMu9sxPlNUcV3JH7GnIolTuITLmo0pJ85u3rv7yVwNhk25CeQA3CpIragzaCvEY7qOSjJD0bbS8c6UojcuU7VL5eCtyPkpvq+Sc0e/pvmvWyKtuJ0iuXWaHbMxHxWCOdPBm3nlSe6ZbdVK4tKJB0+WNUqW4IhwXZ2h0nBTUzZ7578hNr6BLc0ojy7XLk0sGmPSRFOSK2EQHH93XyTVdUZoLSm/I6irlsqJBllIJNoSd2DQ6i6g9eLfmgnhE3PbRmXmlT0HcOCby5uEzHXRg3rBZVrrMpnFZViVoJP8FJN3Am+uD48ZlFntOR4c9edtorAB7Wr5RJdgQehSl9R8zGJF5D4N5pXdjCm9uielgXOYNm2WlL9t/BTqI2Dbs+f0sF3G8uQ44blxmtOd0VP4SDKxGfNkr6ZkjjSrBhtCjKHVfj1m/hinRM9Aj80rvyeje3B7TwYjMGzYrSLevUeW/WGVcVlAJNha8eZ+C4zYfu8Mcshp7Xuyry+0XwqlPwxVUgk2gU1EKAAAAAAAAEKEoBQAAAAAAgNmgKAUAAAAAAIDZoCgFAAAAAACA2aAoBQAAAAAAgNmgKAUAAAAAAIDZoCgFAAAAAACA2aAoBQAAAAAAgNmgKAUAAAAAAIDZoCgFAAAAAACA2aAoBQAAAAAAgNmgKAUAAAAAAIDZoCgFAAAAAACA2aAoBQAAAAAAgNmgKAUAAAAAAIDZoCgFAAAAAACA2fh/W2edM8WVP88AAAAASUVORK5CYII=" width="1244" height="97" class="img_ev3q"></p>
<p>Now I have another module to install, the Groups module. If you&#x27;re following along, now I need three modules:</p>
<ul>
<li class="">Microsoft.Graph.Authentication</li>
<li class="">Microsoft.Graph.Beta.Devices.CorporateManagement</li>
<li class="">Microsoft.Graph.Beta.Groups</li>
</ul>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">if ($filterId -and $filterId.Length -eq 36) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        $filterresponse = Get-MgBetaDeviceManagementAssignmentFilter -DeviceAndAppManagementAssignmentFilterId $filterId</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        $filterName = $filterResponse.displayName</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    catch {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        Write-Warning &quot;Failed to get filter details for ID $filterId&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span></code></pre></div></div>
<p>This one didn&#x27;t take another module to be installed.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="comparing-the-data">Comparing the Data<a href="#comparing-the-data" class="hash-link" aria-label="Direct link to Comparing the Data" title="Direct link to Comparing the Data" translate="no">​</a></h3>
<p>Now that I have the script built, lets compare the results:</p>
<p>Option 1 and 2 CSV Results:</p>
<p><img decoding="async" loading="lazy" alt="CSV Results - Rest Method and Graph" src="/assets/images/results1-ed818d6be92013b35129413fd85a0b53.png" width="1539" height="178" class="img_ev3q"></p>
<p>Cool! Look at all that data it returned. This is my test lab, so I&#x27;m expecting some blank results as I don&#x27;t have a VPP account actually setup.</p>
<p><img decoding="async" loading="lazy" alt="CSV Results - Cmdlets" src="/assets/images/results2-b37c8a674b561602f4bcba0011a179e8.png" width="1305" height="167" class="img_ev3q"></p>
<p>Where&#x27;s Platform? This is just an example of the inconsistency that I talked about earlier. For whatever reason, Platform results aren&#x27;t returned in this example. This was a totally random script I built last week for work and one I thought would be a good use case to show. I literally had no idea that the data would be inconsistent until I built this while writing the article. What are the odds?</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion" translate="no">​</a></h2>
<p><strong>Hopefully</strong> this was a good explainer on the different options for getting started with Microsoft Graph. Going forward, I hope this explained the differences, and why I prefer using Invoke-MgGraphRequest over the others.</p>
<p>In my next post, I want to look at using some automation and create an Application App Registration vs. Delegated, and see how we can pump this data elsewhere (PowerBI) and take a look at that. Have a great day</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="PowerShell related posts." class="tag_zVej tagRegular_sFm0" href="/blog/tags/powershell">PowerShell</a></li><li class="tag_QGVx"><a rel="tag" title="Microsoft Graph API related posts." class="tag_zVej tagRegular_sFm0" href="/blog/tags/graph-api">Graph API</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2025-07-13-getting-started-with-microsoft-graph/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/search-gpocategory"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Finding Group Policy settings by category</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/tech-tools-I-use"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Tech tools I use at home and at work</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#common-terms-and-painpoints" class="table-of-contents__link toc-highlight">Common Terms and Painpoints</a><ul><li><a href="#common-terms" class="table-of-contents__link toc-highlight">Common Terms</a></li></ul></li><li><a href="#getting-started---app-registration" class="table-of-contents__link toc-highlight">Getting Started - App Registration</a></li><li><a href="#authentication" class="table-of-contents__link toc-highlight">Authentication</a><ul><li><a href="#invoke-restmethodget-msaltoken" class="table-of-contents__link toc-highlight">Invoke-RestMethod/Get-MSALToken</a></li><li><a href="#connect-mggraph" class="table-of-contents__link toc-highlight">Connect-MgGraph</a></li></ul></li><li><a href="#option-1-scripting-natively-with-invoke-restmethod" class="table-of-contents__link toc-highlight">Option 1: Scripting natively with Invoke-RestMethod</a></li><li><a href="#option-3-using-graph-powershell-cmdlets" class="table-of-contents__link toc-highlight">Option 3: Using Graph PowerShell Cmdlets</a><ul><li><a href="#find-mggraphcommand" class="table-of-contents__link toc-highlight">Find-MgGraphCommand</a></li><li><a href="#comparing-the-data" class="table-of-contents__link toc-highlight">Comparing the Data</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="footer-icons">
                  <a href="https://github.com/pacers31colts18" class="footer-icon footer-icon-github" target="_blank" rel="noopener noreferrer"></a>
                  <a href="https://linkedin.com/in/joe-loveless" class="footer-icon footer-icon-linkedin" target="_blank" rel="noopener noreferrer"></a>
                  <a href="https://bsky.app/profile/joeloveless.com" class="footer-icon footer-icon-bluesky" target="_blank" rel="noopener noreferrer"></a>
                  <a href="https://infosec.exchange/@Pacers31Colts18" class="footer-icon footer-icon-mastodon" target="_blank" rel="noopener noreferrer"></a>
                  <a href="mailto:joe@joeloveless.com" class="footer-icon footer-icon-email"></a>
                  <a href="https://joeloveless.com/index.xml" class="footer-icon footer-icon-rss" target="_blank" rel="noopener noreferrer"></a>
                </div>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2025 Joe Loveless</div></div></div></footer></div>
</body>
</html>